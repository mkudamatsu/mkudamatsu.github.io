<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<!-- For Google search results -->
		<title>ArcGIS for Economics: Lecture 4</title>
		<meta name="description" content="ArcGIS's distance calculation for economics researchers">
		<meta name="author" content="Masayuki Kudamatsu">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<!-- Activate Reveal.js -->
		<link rel="stylesheet" href="css/reveal.css">

		<!-- Define the theme -->
		<link rel="stylesheet" href="css/theme/white4me.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/tomorrow.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--Add support for earlier versions of Internet Explorer -->
		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<!-- To activate the CSS framework of Reveal.js -->
		<div class="reveal">

			<!-- To reconfigure an HTML5 <section> element as a slide using CSS. -->
			<div class="slides">

				<!-- Slide contents start here -->

				<!-- My own slide templates -->
				<section id="title">
					<h3 style="color:slategrey">
						Causal Inference with Spatial Data
					</h3>
					<p style="color:slategrey">
 						(ArcGIS 10 for Economics Research)
					</p>
					<h3>
						Lecture 4
					</h3>
					<h2>
						Distance as instruments
					</h2>
					<br>
					<p>Masayuki Kudamatsu</p>
					<p>29 August, 2018</p>
					<br>
					<p>
						<small>Press SPACE to proceed. </small>
						<br>
						<small>To go back to the previous slide, press SHIFT+SPACE. </small>
					</p>
				</section>

				<section id="road_map" style="text-align: left;">
					<h3>
						Today's road map
					</h3>
						<p>
							1. When is distance a valid instrument?
						</p>
						<p>
							2. Nunn (2008)
						</p>
						<p>
							3. Distance calculation
						</p>
						<ul>
							<li>
								Exercise 1: Replicate instruments in Nunn (2008)
							</li>
						</ul>
						<p>
							4. Intersect & Surface area calculation
						</p>
						<ul>
							<li>
								Exercise 2: Replicate slave trade data in Nunn (2008)
							</li>
						</ul>
						<p>
							5. List in Python
						</p>
				</section>

			<section>
				<section id="section1" style="text-align: left;">
					<h2>
						1. When is distance a valid instrument?
					</h2>
					<p>
						Let's first look at a few examples of distance used as instruments
					</p>
				</section>

				<section id="oster2012" data-transition="slide-in slide-out" style="text-align: left;">
					<h3>
					<a href="http://dx.doi.org/10.1016/j.jhealeco.2011.12.006" target="_blank">Oster (2012)</a>
					</h3>
						<p>
							HIV prevalence $\uparrow$ $\Rightarrow$ Risky sexual behaviour $\downarrow$
						</p>
						<p class="fragment" data-fragment-index="1">
							Instrument: Distance to DR Congo
						</p>
						<p class="fragment" data-fragment-index="2">
							$\hat{\beta}_{IV} < 0$ while $\hat{\beta}_{OLS} > 0$
						</p>
				</section>

				<section id="wz2007" data-transition="slide-in slide-out" style="text-align: left;">
					<h3>
						<a href="http://dx.doi.org/10.1016/j.jdeveco.2006.03.006" target="_blank">Woodruff & Zenteno (2007)</a>
					</h3>
						<p>
							Migration rate to rich country (Mexico $\rightarrow$ USA) $\uparrow$ $\Rightarrow$ Investment in home country $\uparrow$
						</p>
						<p class="fragment" data-fragment-index="1">
							Instrument: Distance to early 20c railway stations
						</p>
						<p class="fragment" data-fragment-index="2">
							$\hat{\beta}_{IV} > 0$
						</p>
				</section>



				<section id="" data-transition="slide-in slide-out" style="text-align: left;">
					<h4>
						Issues on distance as instruments #1
					</h4>
					<p>
						<small>(cf. <a href="http://dx.doi.org/10.1093/wbro/lkm009" target="_blank">Gibson & McKenzie 2007</a>, p. 227)</small>
					</p>
					<h3>
						Exclusion restriction
					</h3>
						<p>
							Selection in space
						</p>
						<ul>
							<li>
								More affluent can live close to cities, etc.
							</li>
						</ul>
						<p>
							Distance to other things in the same place
						</p>
						<ul>
							<li>
								e.g. Distance to cities: access to markets, schools, clinics...
							</li>
							<li>
								Closer to DR Congo <br>$\Rightarrow$ Higher mortality due to proximity to conflict?
							</li>
							<li>
								Closer to historical railway stations <br> $\Rightarrow$ More prosperous due to path dependence?
							</li>
						</ul>

				</section>

				<!-- <section id="rogall_iv" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						<a href="https://docs.google.com/viewer?a=v&pid=sites&srcid=ZGVmYXVsdGRvbWFpbnx0aG9yc3RlbnJvZ2FsbHxneDoyYTkzZjNkODVjMTcxYzA5" target="_blank">Rogall (2014)</a>
					</h3>
						<p>
							Presence of armed groups <br> $\Rightarrow$ Civilian participation in Rwandan genocide $\uparrow$
						</p>
					<img src="gis_lecture4/rogall2014f4.png" style="border: none; background: none; box-shadow:none; width: 450px; float: left">
						<p style="text-align: center;">
							Instrument:
						</p>
						<p style="text-align: center;">
							Distance to main road
						</p>
						<p style="text-align: center;">x</p>
						<p style="text-align: center;">rainfall along the dirt track to main road during genocide</p>
				</section>

				<section id="" data-transition="fade-in slide-out" style="text-align: left;">
					<img src="gis_lecture4/rogall2014f4.png" style="border: none; background: none; box-shadow:none; width: 450px; float: left">
						<p>
							By the end of this lecture, you'll be able to obtain:
						</p>
						<ul>
							<li>
								Village centroids
							</li>
							<li>
								Distance to main roads
							</li>
							<li>
								Shortest distance routes
							</li>
						</ul>
						<p>
							Use Buffer (cf. <a href="../gis_lecture3.html#/buffer1" target="_blank">Lec 3</a>) to identify 500m rainfall buffers
						</p>
						<br>
						<p>
							<small>
								cf. The author took this GIS course, which made this research feasible.
							</small>
						</p>
				</section> -->

				<section id="" data-transition="slide-in slide-out" style="text-align: left;">
					<h4>
						Issues on distance as instruments #2
					</h4>
					<p>
						<small>(cf. <a href="http://dx.doi.org/10.1093/wbro/lkm009" target="_blank">Gibson & McKenzie 2007</a>, p. 227)</small>
					</p>
					<h3>
						LATE
					</h3>
						<p>
							Treatment can be induced by other factors than distance
						</p>
						<p>
							Is LATE of interest? (cf. <a href="http://dx.doi.org/10.1257/jel.48.2.399" target="_blank">Imbens 2010</a>)
						</p>
				</section>

				<!-- <section id="" data-transition="fade-in slide-out" style="text-align: left;">
					<h3>
						<a href="http://dx.doi.org/10.1111/j.1542-4774.2010.tb00544.x" target="_blank">McKenzie et al. (2010)</a>
					</h3>
						<p>
							Migration to rich country (Tonga $\rightarrow$ NZ) $\Rightarrow$ Income $\uparrow$
						</p>
						<p class="fragment" data-fragment-index="1">
							Instrument: Distance to NZ's Dept. of Labor office
						</p>
						<p class="fragment" data-fragment-index="1">
							LATE is relevant: distance is the sole determinant of migration
						</p>
						<p class="fragment" data-fragment-index="2">
							$\hat{\beta}_{OLS} > \hat{\beta}_{IV} > 0$
						</p>
				</section> -->
			</section>

			<section>
				<section id="section2" style="text-align: left;">
					<h2>
						2. <a href="http://dx.doi.org/10.1162/qjec.2008.123.1.139" target="_blank">Nunn (2008)</a>
					</h2>
					<p>
						Perhaps the best example of using distance as instruments
					</p>
				</section>

				<section id="rq1" data-transition="slide-in slide-out" style="text-align: left;">
					<h3>Research Question</h3>
					<p>
						Did slave trades cause African underdevelopment?
					</p>
					<p>
						Important?
					</p>
					<ul>
						<li>
							Many conjecture slave trades adversely affected Africa's living standards
						</li>
					</ul>
					<p>
						Original?
					</p>
					<ul>
						<li>
							First systematic and convincing evidence of causality
						</li>
					</ul>
					<p>
						Feasible?
					</p>
				</section>

				<section id="data1" data-transition="slide-in slide-out" style="text-align: left;">
					<h4>Data</h4>
					<h3>Treatment variable</h3>
					<p>
						# of slaves exported from each country: constructed from
					</p>
					<p style="margin-left: 27px;">
						(1) # of slaves exported from each port of Africa
					</p>
					<p style="margin-left: 27px;">
						(2) Ethnicity of a sample of 100,000+ slaves shipped from Africa
					</p>
					<p style="margin-left: 27px;">
					  (3) Murdock's (1959) map of ethnic homelands in Africa
					</p>
					<p class="fragment"  data-fragment-index="1">
						We will learn how to allocate (1) across countries <br> by intersecting (3) with country polygons
					</p>
				</section>

				<section id="data2" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>Data (cont.)</h4>
					<h3>Instruments</h3>
					<img src="gis_lecture4/Nunn2008F5.png" style="border: none; background: none; box-shadow:none; width: 600px; float: right;">
					<p>
						Distance to nearest slave trade centers
					</p>
					<ul>
						<li>
							Trans-Atlantic
						</li>
						<li>
							Indian Ocean
						</li>
						<li>
							Trans-Saharan
						</li>
						<li>
							Red Sea
						</li>
					</ul>
				</section>

				<section id="data2" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>Data (cont.)</h4>
					<h3>Instruments</h3>
					<img src="gis_lecture4/Nunn2008F5.png" style="border: none; background: none; box-shadow:none; width: 600px; float: right;">
					<p>
						Distance to nearest slave trade centers
					</p>
					<ul>
						<li style="color: red; ">
							Trans-Atlantic
						</li>
						<li>
							Indian Ocean
						</li>
						<li>
							Trans-Saharan
						</li>
						<li>
							Red Sea
						</li>
					</ul>
					<p>
						We will learn how to obtain distance to Trans-Atlantic trade centers
					</p>
				</section>

				<section id="nunn2008exclusion" data-transition="slide-in fade-out" style="text-align: left;">
					<h3>
						Exclusion restrictions
					</h3>
					<p>
						Selection in space?
					</p>
						<ul>
							<li>
								Location of slave trade centers:
							</li>
								<ul>
									<li>
										Determined by climate suitability of plantation crops / location of mines (p. 160)
									</li>
									<li>
										Not affected by distance to slave export locations in Africa
									</li>
								</ul>
						</ul>
						<p>
							Distance to other things in the same place?
						</p>
						<ul>
							<li>
								Slave markets $\neq$ 	other economic opportunities
							</li>
							<li>
								Reduced-form correlation is absent outside Africa (p. 163)
							</li>
						</ul>
				</section>

				<section id="nunn2008late" data-transition="fade-in slide-out" style="text-align: left;">
					<h3>
						LATE
					</h3>
						<p>
							Maybe a smaller impact if countries voluntarily engaged in slave trades
						</p>
						<p>
							But LATE may be of more interest in this context
						</p>
				</section>

				<section id="equation1" data-transition="fade-out slide-in" style="text-align: left">
					<h3>
						Empirical specification (2nd stage)
					</h3>
					<br>
					<p>
						<!-- Case by Case -->
						\begin{align*}
						y_{i} =
						& \ \alpha + \beta \ln \Big(\frac{exports_i}{area_i}\Big) + \boldsymbol{X}'_{i}\boldsymbol{\gamma} + \varepsilon_{i}
						\end{align*}
					</p>
					<br>
					<table border="0" width="100%">
						<tr>
							<td style="text-align: center">$y_{i}$</td>
							<td>GDP per capita in country $i$ in 2000</td>
						</tr>
						<tr>
							<td style="text-align: center">$exports_i$</td>
							<td># of slaves exported 1400-1900 from country $i$</td>
						</tr>
						<tr>
							<td style="text-align: center">$area_i$</td>
							<td>Land surface area of country $i$</td>
						</tr>
						<tr>
							<td style="text-align: center">$\boldsymbol{X}_{i}$</td>
							<td>Controls</td>
						</tr>
					</table>
				</section>


				<section id="equation2" data-transition="fade-out fade-in" style="text-align: left">
					<h3>
						Empirical specification (1st stage)
					</h3>
					<br>
					<p>
						<!-- Case by Case -->
						\begin{align*}
						\ln \Big(\frac{exports_i}{area_i}\Big)  =
						& \ \ \delta + \boldsymbol{D}'_i\boldsymbol{\Omega} +  \boldsymbol{X}'_{i}\boldsymbol{\eta} + \mu_{i} \\
						\end{align*}
					</p>
					<br>
					<table border="0" width="100%">
						<tr>
							<td style="text-align: center">$\boldsymbol{D}_i$</td>
							<td>Distance to nearest slave trade centers</td>
						</tr>
					</table>
				</section>

				<section id="controls" data-transition="fade-in slide-out" style="text-align: left;">
					<h3>
					</h3>
						<p>
							We will learn how to obtain some of controls with ArcGIS
						</p>
						<ul>
							<li>
								Distance from equator (i.e. latitude of centroid)
							</li>
							<li>
								Longitude of country $i$'s centroid
							</li>
						</ul>
				</section>

				<section id="result1"  data-transition="slide-in fade-out">
					<h4>
						1st stage results
					</h4>
					<img src="gis_lecture4/Nunn2008T4.png" style="border: none; background: none; box-shadow:none; width: 800px;">
					<p>
						<small>(Table IV of <a href="http://dx.doi.org/10.1162/qjec.2008.123.1.139" target="_blank">Nunn 2008</a>)</small>
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Weak instruments
					</h3>
						<p>
							F-stat on excluded instruments: very low
						</p>
						<p>
							$\Rightarrow$ <a href="http://dx.doi.org/10.1111/1468-0262.00438" target="_blank">Moreira's (2003)</a> CLR confidence intervals
						</p>
						<ul style="margin-left: 85px;">
							<li>
								Stata ado: <code>condivreg</code>
							</li>
							<li>
								Works only for single endogenous regressor
							</li>
							<li>
								For multiple endogenous regressors, use LIML with <a href="http://www.jstor.org/stable/2951662" target="_blank">Bekker's (1994)</a> s.e. correction (cf. <a href="http://www.nber.org/WNE/lect_13_weakmany_iv.pdf" target="_blank">Imbens 2007</a>)
							</li>
						</ul>
				</section>

				<section id="result2"  data-transition="fade-in slide-out">
					<h4>
						2nd stage results
					</h4>
					<img src="gis_lecture4/Nunn2008T4a.png" style="border: none; background: none; box-shadow:none; width: 800px;">
					<p>
						<small>(Table IV of <a href="http://dx.doi.org/10.1162/qjec.2008.123.1.139" target="_blank">Nunn 2008</a>)</small>
					</p>
				</section>

				<section id="" data-transition="slide-in slide-out" style="text-align: left;">
					<h3>
						Mechanisms
					</h3>
						<p>
							Ethnic fractionalization
						</p>
						<p>
							Weaker state
						</p>
						<p>
							Low interpersonal trust (<a href="http://dx.doi.org/10.1257/aer.101.7.3221" target="_blank">Nunn & Wantchekon 2011</a>)
						</p>
				</section>

			</section>


				<!-- Preparation -->
				<section id="preparation1" data-transition="slide-in fade-out" style="text-align: left;">
					<h3>
						Prepare for the rest of this lecture
					</h3>
					<p>
						1. Launch ArcMap 10 (it takes time)
					</p>
					<p>
						2. <a href="https://www.dropbox.com/s/fq2h2k89cin3yzv/Lecture4.zip?dl=0" target="_blank">Download the zipped dataset for lecture 4</a>
					</p>
					<p>
						3. Save it to <strong>Desktop</strong> (<code>C:\\Users\\<em>yourname</em>\\Desktop</code>)
					</p>
					<ul style="margin-left: 72px;">
						<li>
							 Don't save in the remote server, which slows down ArcGIS
						</li>
					</ul>
					<p>
						4. Right-click it and choose <span style="background-color: Gainsboro">7-Zip > Extract to "Lecture4\"</span>
					</p>
					<ul style="margin-left: 72px;">
						<li>
							 So the directory path will be: <code>C:\\Users\\<em>yourname</em>\\Desktop\\Lecture4</code>
						</li>
					</ul>
				</section>

				<section id="preparation2" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
						Prepare for the rest of this lecture (cont.)
					</h4>
					<p>
						5. Right-click the following zipped data and choose <span style="background-color: Gainsboro">7-Zip > Extract Here</span>
					</p>
					<ul>
						<li>
							<code>10m-coastline.zip</code> (coastlines)
						</li>
						<li>
							<code>Murdock_shapefile.zip</code> (ethnic homelands)
						</li>
					</ul>
				</section>


				<section id="preparation3" data-transition="slide-out fade-in" style="text-align: left;">
					<h4>
						Prepare for the rest of this lecture (cont.)
					</h4>
					<p>
						Now in ArcMap's <strong>Catalogue Window</strong>:
					</p>
					<p>
						6. Establish connection to data folder
					</p>
					<ul style="margin-left: 72px;">
						<li style="margin-bottom: 5px;">
							Right-click <span style="background-color: Gainsboro">Folder Connections</span>
						</li>
						<li style="margin-bottom: 5px;">
							Select <span style="background-color: Gainsboro">Connect to Folder</span>
						</li>
						<li>
							Choose <span style="background-color: Gainsboro">Desktop > Lecture4</span>
						</li>
					</ul>
					<p>
						7. Prepare the Model Builder
					</p>
					<ul style="margin-left: 72px;">
							<li>
								<a href="../gis_lecture1.html#/modelbuilder1" target="_blank">Create a Model</a> and <a href="../gis_lecture1.html#/modelbuilder3" target="_blank">Save it</a> as "<code>exercise1</code>" and "<code>exercise2</code>" inside <code>code/models.tbx</code>
							</li>
					</ul>
				</section>

			<section>
				<section id="section3">
					<h1>
						3. Distance calculation
					</h1>
					<p>
						Depends on input feature types
					</p>
					<ol>
						<li>
							Point to point
						</li>
						<li>
							Point to polyline
						</li>
						<li>
							From polygon
						</li>
					</ol>
				</section>

				<section id="distance1" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
						Distance calculation #1
					</h4>
					<h3>
						Point to point
					</h3>
						<p>
							1. Obtain geographic coordinates
						</p>
						<p>
							2. Use the Great Circle Distance formula
						</p>
						<p>
							\begin{align*}
							d_{ij} =& \ 111.12 \times \cos^{-1}\big[\sin(La_i)\sin(La_j) \\ 								& + \cos(La_i)\cos(La_j)\cos(Lo_i-Lo_j)\big]
							\end{align*}
						</p>
						<ul style="margin-left: 82px;">
							<li>
								$d_{ij}$: distance in km from $i$ to $j$
							</li>
							<li>
								Proof: see <a href="http://mathworld.wolfram.com/GreatCircle.html" target="_blank"> Wolfram MathWorld</a>
							</li>
							<li>
							Can be implemented by Stata ado <code>globdist</code>
							</li>
						</ul>
				</section>

				<section id="globdist" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
						Globdist
					</h4>
						<p>
							1. In Stata, type: <code>findit globdist</code>, to install
						</p>
						<p>
							2. Prepare the data so that
						</p>
						<ul>
							<li>
								lat / lon: coordinates of each observation
							</li>
							<li>
								lat_i / lon_i: coordinates of location $i$
							</li>
						</ul>
						<p>
							3. Type:
								<code style="display:block;">
									globdist newvar, lat0(lat_i) lon0(lon_i)
								</code>
						</p>
						<ul>
							<li>
								<code>newvar</code>: distance to location $i$
							</li>
							<li>
								use latvar(), lonvar(), to specify coordinate variables if not named lat / lon
							</li>
						</ul>
				</section>

				<section id="utm_distance" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
						Alternative method for small areas
					</h4>
						<p>
							UTM projection (cf.  <a href="../gis_lecture3.html#/section4" target="_blank">Lec 3</a>) + Pythagorean theorem
						</p>
						<ul>
							<li>
								For study area spanning < 6&deg in longitude
							</li>
						</ul>
				</section>

				<section id="distance2" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
						Distance calculation #2
					</h4>
					<h3>
						Point to polyline
					</h3>
						<p>
						    Examples: distance to roads, railway lines, rivers...
						</p>
						<p>
							Need the coordinate of nearest point on the polyline
						</p>
						<p>
							Use ArcGIS's Near tool
						</p>
						<ul>
							<li>
								It also calculates the distance to nearest point
							</li>
						</ul>
						<p>
							Application: Redding & Sturm (2008)
						</p>
				</section>

				<section id="redding-sturm" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
						Detour: <a href="http://dx.doi.org/10.1257/aer.98.5.1766" target="_blank">Redding & Sturm (2008)</a>
					</h4>
					<img src="gis_lecture4/RS2008map.png" style="border: none; background: none; box-shadow:none; width: 600px; float: right;">
					<p>
						West German cities near the border with East Germany:
					</p>
					<p>
						Population growth $\downarrow$ after 1945
					</p>
					<p>
						Distance to border: can be obtained by Near tool
					</p>
				</section>


				<section id="distance3" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
						Distance calculation #3
					</h4>
					<h3>
						From polygon
					</h3>
						<p>
							We have two cases
						</p>
						<ol>
							<li>
								From the edge of a polygon
							</li>
							<li>
								From the centroid of a polygon
							</li>
						</ol>
				</section>

				<section id="distance3a" data-transition="fade" style="text-align: left;">
					<h4>
						Distance calculation #3.1
					</h4>
					<h3>
						From the edge of a polygon
					</h3>
						<p>
							We can just use the Near tool
						</p>
						<img src="gis_lecture4/distance_from_polygon.png" style="border: none; background: none; box-shadow:none; width: 500px;">
				</section>

				<section id="distance3b" data-transition="fade" style="text-align: left;">
					<h4>
						Distance calculation #3.2
					</h4>
					<h3>
						From the centroid of a polygon
					</h3>
						<p>
							More appropriate when mean distance from any point within a polygon matters
						</p>
						<p>
							To calculate the distance <span style="color:red;">to a point</span>:
						</p>
						<ul>
							<li>
								Obtain the coordinate of a polygon centroid by:
							</li>
							<ul>
								<li>
									Stata ado <a href="http://www.haghish.com/statistics/stata-blog/stata-programming/download/shp2dta.html" target="_blank"><code>shp2dta</code></a> (cf. <a href="../gis_lecture2.html#/export3" target="_blank">Lec 2</a>)
								</li>
								<li>
									Add Geometry Attributes in ArcGIS (cf. <a href="../gis_lecture2.html#/f2p" target="_blank">Lec 2 Ex 1 Step 3</a>)
								</li>
							</ul>
							<li>
								Then use the Great Circle Distance formula
							</li>
							<ul>
								<li>Stata ado <code>globdist</code></li>
							</ul>
						</ul>
						<p>
							Application: Campante & Do (2014)
						</p>
				</section>

				<section id="campante-do" data-transition="fade" style="text-align: left;">
					<h4>
						Detour: <a href="http://dx.doi.org/10.1257/aer.104.8.2456" target="_blank">Campante & Do (2014)</a>
					</h4>
					<p>
						Population concentration around US state capital city
					</p>
					<ul>
						<li>
						Measured by the <em>distance</em>-weighted sum of county population
						</li>
						<li>
						Distance: btw capital and county <em>centroids</em>
						</li>
					</ul>
					<p>
						$\Rightarrow$ US state govt quality $\uparrow$
					</p>
					<ul style="margin-left: 85px;">
						<li>
							Newspaper coverage of state politics $\uparrow$
						</li>
						<li>
							Money politics $\downarrow$
						</li>
						<li>
							Public good provision $\uparrow$
						</li>
					</ul>
				</section>

				<section id="distance3c" data-transition="fade" style="text-align: left;">
					<h4>
						Distance calculation #3.2 (cont.)
					</h4>
					<h3>
						From the centroid of a polygon
					</h3>
						<p>
							To calculate the distance <span style="color:red;">to a polyline/polygon</span>:
						</p>
						<ol>
							<li>
								Create centroid point features in ArcGIS
							</li>
							<ul>
								<li>
									Feature To Point
								</li>
								<li>
									Add XY Coordinates
								</li>
							</ul>
							<li>
								Use the Near tool
							</li>
						</ol>
						<p>
							Application: Nunn (2008)
						</p>
				</section>

				<section id="ex1a" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
					Exercise #1: Overview
					</h4>
					<h3>
						Replicate instruments in Nunn (2008): Distance to Slave trade centers
					</h3>
					<figure style="margin:auto; width: 60%;">
						<img src="gis_lecture4/Nunn2008F5.png" style="border: none; background: none; box-shadow:none; max-width: 100%;">
					</figure>
				</section>

				<section id="ex1b" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
					Exercise #1: Overview (cont.)
					</h4>
					<p>
					We proceed in three steps:
				  </p>
					<p>
						1. Create <strong>country centroid</strong> point features
					</p>
						<ul style="margin-left: 72px;">
							<li>
								Used as control variables as well
							</li>
						</ul>
					<p>
						2. Identify <strong>closest point on the coast</strong> from country centroid
					</p>
					<p>
						3. Calculate distance to <strong>closest slave trade centers</strong>
					</p>
						<ul style="margin-left: 72px;">
							<li>
								Trade center coordinates: use online gazetteer (cf. <a href="../gis_lecture1.html#/xydata2b" target="_blank">Lecture 1</a>)
							</li>
						</ul>
					</section>

				<section id="ex1centroids" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
					Exercise #1: Step 1
					</h4>
					<h3>
						Obtain country centroids
					</h3>
					<p>
						Input: Country polygons for Africa
					</p>
						<ul style="margin-left: 72px;">
							<li>
								Created by the lecturer from GADM (cf. <a href="http://127.0.0.1:3000/gis_lecture1.html#/ex1a" target="_blank">Lec 1 Ex 1</a>)
							</li>
						</ul>
					<p>
						Geo-processing tools:
					</p>
					<ul style="margin-left: 72px;">
						<li>
							Feature To Point
						</li>
						<li>
							Add XY Coordinates
						</li>
					</ul>
				</section>

				<section id="ex1ftp" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
					Exercise #1: Step 1
					</h4>
					<h3>
						Feature To Point
					</h3>
					<p>
						<strong>Input Features</strong>: <code>...\Lecture4\input\gadm36_africa.shp</code>
					</p>
					<ul>
						<li>
							Country polygons
						</li>
					</ul>
					<p>
						<strong>Output Feature Class</strong>: <code>...\Lecture4\temporary\centroids.shp</code>
					</p>
					<p>
						Uncheck "<strong>Inside</strong>"
					</p>
					<ul>
						<li>
							How this option works: "[F]ind a location in a relatively wide or open area inside the polygon and to avoid a location being too close to the polygon boundary" (personal correspondence with ESRI)
						</li>
					</ul>
				</section>

				<section id="ex1ftp2" data-transition="fade-in fade-out" style="text-align: left;">
          <h4>
          Exercise #1: Step 1 (cont.)
          </h4>
					<p>
						Now <em>save and</em> run the Model.
					</p>
					<p>
						Overlay the output over <code>gadm36_africa.shp</code>.
					</p>
					<p>
						You should see something like this:
					</p>
					<img src="gis_lecture4/feature-to-point-result.png" style="border: 1px solid grey; background: none; box-shadow:none; width: 500px;">
        </section>

				<section id="ex1ftp3" data-transition="fade-in fade-out" style="text-align: left;">
          <h4>
          Exercise #1: Step 1 (cont.)
          </h4>
					<p>
						Also browse the attritube table.
					</p>
          <p>
            Notice that Feature To Point doesn't add coordinates to the attribute table of the output.
          </p>
					<p>
						So...
					</p>
        </section>

				<section id="ex1addxy" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
					Exercise #1: Step 1 (cont.)
					</h4>
					<h3>
						Add XY Coordinates (Data Management)
					</h3>
					<p>
						<strong>Input Features</strong>: centroids.shp
					</p>
					<ul>
						<li>
							The output from Feature To Point
						</li>
					</ul>
					<p>
						NOTE: This tool overwrites the input data.
					</p>
					<p class="fragment"  data-fragment-index="1">
						You might wonder if we can use Add Geometry Attribute, but it works only for polygons.
					</p>
				</section>

				<section id="ex1addxy2" data-transition="fade-in slide-out" style="text-align: left;">
          <h4>
          Exercise #1: Step 1 (cont.)
          </h4>
					<p>
						Now <em>save and</em> run the Model.
					</p>
					<p>
						Browse the attribute table. Now you should see two new fields POINT_X and POINT_Y.
					</p>
					<img src="gis_lecture4/add-xy-coordinate-result.png" style="border: none; background: none; box-shadow:none; width: 550px;">
        </section>

				<section id="ex1coast" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
					Exercise #1: Step 2
					</h4>
					<h3>
						Closest point on the coast
					</h3>
					<p>
						Inputs: Coastline polylines
					</p>
					<ul style="margin-left: 72px;">
						<li>
							<a href="http://www.naturalearthdata.com/downloads/10m-physical-vectors/10m-coastline/" target="_blank">Natural Earth 1:10m Physical Vector "Coastline"</a>
						</li>
					</ul>
					<p>
						Geo-processing tool: <strong>Near (Analysis)</strong>
					</p>
					<ul style="margin-left: 72px;">
						<li>
							<strong>Generate Near Table</strong> tool does the same job
						</li>
						<li>
							But it will drop country names...
						</li>
					</ul>
				</section>

				<section id="near" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						What Near tool does
					</h3>
					<img src="gis_lecture4/near.png" style="border: none; background: none; box-shadow:none; width: 700px;">
					<p>
						<small>(source: <a href="http://desktop.arcgis.com/en/arcmap/latest/tools/analysis-toolbox/near.htm" target="_blank">ArcGIS Help on Near</a>)</small>
					</p>
				</section>

				<section id="ex1near1" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
					Exercise #1: Step 2
					</h4>
					<h3>
						Near (Analysis)
					</h3>
					<p>
						<strong>Input Features</strong>: country_centroids.shp (2)
					</p>
					<ul>
						<li>
							Output from Add XY Coordinates
						</li>
					</ul>
					<p>
						<strong>Near Features</strong>: <code>...\Lecture4\input\10m_coastline.shp</code>
					</p>
					<ul>
						<li>
							Coastline polyline features
						</li>
					</ul>
					</section>
				<section id="ex1near2" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
					Exercise #1: Step 2 (cont.)
					</h4>
					<p>
						Check "<strong>Location</strong>"
					</p>
					<ul>
						<li>
							Otherwise the coordinate of the nearest point on coast won't be attached to attribute table
						</li>
					</ul>
					<p>
						<strong>Method</strong>: GEODESIC
					</p>
					<ul>
						<li>
							Calculates distance by Great Circle Distance Formula
						</li>
						<li>
							If we use data in UTM, choose PLANAR.
						</li>
					</ul>
					<p>
						NOTE: This tool overwrites the input data.
					</p>
				</section>

				<section id="ex1near3" data-transition="fade-in slide-out" style="text-align: left;">
          <h4>
          Exercise #1: Step 2 (cont.)
          </h4>
					<p>
						Now <em>save and</em> run the Model. Browse the attribute table. Now you should see four new fields:
					</p>
					<ul>
						<li>
							<strong>NEAR_FID</strong>: FID of coastline segment
						</li>
						<li>
							<strong>NEAR_DIST</strong>: Distance to coast in meters
						</li>
						<li>
							<strong>NEAR_X</strong>: Longitude of the nearest point on coast
						</li>
						<li>
							<strong>NEAR_Y</strong>: Latitude of the nearest point on coast
						</li>
					</ul>
					<img src="gis_lecture4/near-result.png" style="border: none; background: none; box-shadow:none; width: 700px;">
        </section>

				<section id="ex1step3a" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
					Exercise #1: Step3
					</h4>
					<h3>
						Distance to slave trade centers
					</h3>
					<p>
						Approach 1: use <code>globdist</code>
					</p>
					<ol>
						<li>
							Table to Excel, to export the output from Near tool
						</li>
						<li>
							In Stata, use <code>globdist</code> to calculate distance between nearest point on the coast (NEAR_X, NEAR_Y) and all slave trade centers.
						</li>
						<li>
							Pick the shortest distance
						</li>
					</ol>
				</section>

				<section id="ex1step3b" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
					Exercise #1: Step3 (cont.)
					</h4>
					<h3>
						Distance to slave trade centers
					</h3>
					<p>
						Approach 2: use the Near tool in ArcGIS
					</p>
					<ol>
						<li>
							Create slave trade center point features
						</li>
						<li>
							Create nearest coast point features (use NEAR_X, NEAR_Y)
						</li>
						<li>
							Use Near (near features: slave trade centers)
						</li>
						<li>
							Table to Excel
						</li>
					</ol>
				</section>

				<section id="model_model1" data-transition="slide-in slide-out" style="text-align: left;">
					<h3>
					"Model" models for Exercise 1
					</h3>
					<p>
						In the <code>Lecture4\solutions4exercises</code> folder, you can find
						<code>models.tbx\exercise1</code>
					</p>
				</section>

				<section id="" data-transition="slide-in slide-out" style="text-align: left;">
					<h4>
						Extra exercise #1
					</h4>
					<h3>
						Centroids outside polygons
					</h3>
						<p>
							Nunn (2008, p. 170): "For five countries where the centroid falls outside the land borders of the country (Gambia, Somalia, Cape Verde, Mauritius, and Seychelles) the point within the country closest to the centroid is used."
						</p>
						<p>
							This can be done by the Near tool
						</p>
						<ul>
							<li>
								Near features: country polygons
							</li>
							<li>
								(NEAR_X, NEAR_Y) will be different for those centroids outside polygons
							</li>
						</ul>
				</section>

				<section id="xy2line" data-transition="slide-in slide-out" style="text-align: left;">
					<h4>
						Extra exercise #2
					</h4>
					<h3>
						Shortest distance route polylines
					</h3>
						<p>
							To make a map that indicates the shortest distance:
						</p>
						<p>
							Use the <strong>XY To Line</strong> tool
						</p>
						<ul>
							<li>
								<strong>Input Table</strong>: the output from Near tool
							</li>
							<li>
								<strong>Start X Field / Y Field</strong>: POINT_X / POINT_Y
							</li>
							<li>
								<strong>End X Field / Y Field</strong>: NEAR_X / NEAR_Y
							</li>
						</ul>
						<!-- <p>
							Application: <a href="#/rogall_iv" target="_blank">Rogall (2014)</a> to create input polyline features for Buffer
						</p> -->
				</section>

				<section id="model_script1" data-transition="slide-out slide-in" style="text-align: left;">
					<h3>
					Model Python Script for Exercise 1
					</h3>
					<p>
						Due to time constraint, we skip Python for Exercise 1
					</p>
					<p>
						Model Python scripts: see <code>Lecture4/solutions4exercises/exercise1.py</code>
					</p>
				</section>

			</section>

			<!-- SECTION for ArcMap -->
			<section>
				<section id="section4">
					<h1>
						4. Intersect + Surface Area Calculation
					</h1>
				</section>

				<section id="aim1" data-transition="fade-out slide-in" style="text-align: left">
					<h3>
						Data we want to construct
					</h3>
					<p>
						# of slaves exported from each country in Africa
					</p>
					<p>
						Input datasets:
					</p>
					<ul>
						<li>
							# of slaves shipped from each <em>coastal</em> country
						</li>
						<li>
							Each ethnic group's share in the total # of slaves exported from Africa
						</li>
						<li>
							Ethnic homeland map (cf. <a href="../gis_lecture1.html#/oldmap2b" target="_blank">Lecture 1</a>)
						</li>
					</ul>
				</section>

				<section id="aim2" data-transition="fade-out fade-in" style="text-align: left">
					<h4>
						Data we want to construct (cont.)
					</h4>
					<h3>
						Input data (hypothetical)
					</h3>
					<img src="gis_lecture4/inputdata.png" style="border: none; background: none; box-shadow:none; width: 800px;">
				</section>

				<section id="aim3" data-transition="fade-out fade-in" style="text-align: left">
					<h4>
						Data we want to construct (cont.)
					</h4>
					<h3>
						Assign slaves from coast to inland
					</h3>
					<img src="gis_lecture4/slave1.png" style="border: none; background: none; box-shadow:none; width: 800px;">
				</section>

				<section id="aim4" data-transition="fade-out fade-in" style="text-align: left">
					<h4>
						Data we want to construct (cont.)
					</h4>
					<h3>
						Superimpose country boundaries
					</h3>
					<img src="gis_lecture4/slave2.png" style="border: none; background: none; box-shadow:none; width: 800px;">
					<p>
						Surface area of ethnic C: 50% for X / 50% for Y
					</p>
				</section>

				<section id="aim5" data-transition="fade-out fade-in" style="text-align: left">
					<h4>
						Data we want to construct (cont.)
					</h4>
					<h3>
						Deal with split ethnic homelands
					</h3>
					<img src="gis_lecture4/slave3.png" style="border: none; background: none; box-shadow:none; width: 800px;">
					<p>
						$\Rightarrow$ Assign slaves by <em>surface area</em> (Nunn 2008, fn. 4)
					</p>
				</section>

				<section id="aim6" data-transition="fade-out fade-in" style="text-align: left">
					<h4>
						Data we want to construct (cont.)
					</h4>
					<h3>
						# of slaves exported by country
					</h3>
					<img src="gis_lecture4/slave4.png" style="border: none; background: none; box-shadow:none; width: 800px;">
				</section>

				<section id="aim7" data-transition="slide-out fade-in" style="text-align: left">
					<h4>
						Data we want to construct (cont.)
					</h4>
					<h3>
						Use ArcGIS to create:
					</h3>
					<p>
						Ethnic homeland by country intersection polygons
					</p>
					<p>
						Attribute table:
					</p>
					<ul style="margin-left: 72px;">
						<li>
							Country ID
						</li>
						<li>
							Ethnic group ID
						</li>
						<li>
							Surfare area
						</li>
					</ul>
					<br>
					<p>
						Then export to Stata to do the other calculations...
					</p>
				</section>

				<section id="ex2inputs" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
					Exercise #2
					</h4>
					<h3>
						Surface area of intersection polygons
					</h3>
					<p>
						Input data:
					</p>
					<p>
						1. Ethnic homeland polygons (<code>borders_tribes.shp</code>)
					</p>
						<ul style="margin-left: 72px;">
							<li>
								Downloaded from <a href="http://scholar.harvard.edu/nunn/pages/data-0" target="_blank">Nathan Nunn's website</a>
							</li>
						</ul>
					<p>
						2. Country polygons (<code>african_countries.shp</code>)
					</p>
				</section>

				<section id="ex2tools" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
					Exercise #2 (cont.)
					</h4>
					<p>
						Geo-processing tools:
					</p>
					<p>
						1. Intersect (Analysis)
					</p>
						<ul style="margin-left: 72px;">
							<li>
								 Match ethnic homelands with countries
							</li>
						</ul>
					<p>
						2. Project (Data Management)
					</p>
						<ul style="margin-left: 72px;">
							<li>
								Choose coordinate system for surface area calculation
							</li>
						</ul>
					<p>
						3. Add Geometry Attributes
					</p>
						<ul style="margin-left: 72px;">
							<li>
								Calculate surfare area as a new field of attribute table
							</li>
						</ul>
				</section>

				<section id="ex2intersect1" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
					Exercise #2: Step 1
					</h4>
					<h3>
						Intersect (Analysis)
					</h3>
					<p>
						<strong>Input Features</strong> (<code>Lecture4/input</code> folder)
					</p>
						<p>
							<code>borders_tribes.shp</code>
						</p>
						<p>
							<code>african_countries.shp</code>
						</p>
					<ul style="margin-left: 72px;">
						<li>
							Use shift+click to select more than one file
						</li>
					</ul>
					<p>
						<strong>Output Feature Class</strong>: <code>...\Lecture4\temporary\intersect.shp</code>
					</p>
					<p>
						<strong>Join Attributes</strong>: ALL
					</p>
					<p>
						<strong>Output Type</strong>: INPUT
					</p>
				</section>

				<section id="ex2intersect2" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
					Exercise #2: Step 1 (cont.)
					</h4>
					<p>
						Now <em>save and</em> run the Model.
					</p>
					<p>
						Browse the output.
					</p>
					<p>
						Browse the attribute table of the output
					</p>
				</section>

				<section id="intersect1" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Intersect vs Spatial Join
					</h3>
						<p>
							If only to know which ethnic group lives in which country
						</p>
						<p>
							$\Rightarrow$ <strong>Spatial Join</strong> (with JOIN_ONE_TO_MANY option)
						</p>
						<ul style="margin-left: 85px;">
							<li>
								Output features: target features
							</li>
						</ul>
						<p>
							To obtain data at the intersection level
						</p>
						<p>
							$\Rightarrow$ <strong>Intersect</strong>
						</p>
						<ul style="margin-left: 85px;">
							<li>
								Output features: intersection polygons
							</li>
						</ul>
				</section>

				<section id="intersect2" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
						Application of Intersect tool:
					</h4>
					<h3>
						Detour: <a href="http://dx.doi.org/10.1093/qje/qjs011" target="_blank">Bleakey & Lin (2012)</a>
					</h3>
					<p>
						<strong>Intersect</strong> <a href="http://global.britannica.com/science/fall-line" target="_blank">fall lines</a> + rivers to identify potential portage sites
					</p>
					<img src="gis_lecture4/BL2012F4.png" style="border: none; background: none; box-shadow:none; width: 500px; float: center">
				</section>

				<section id="area_calculation1" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
					Exercise #2 (cont.)
					</h4>
					<h3>
						Surface area calculation
					</h3>
						<p>
							Use equal area projections
						</p>
						<ul>
							<li>
								Study area: whole Africa
							</li>
							<li>
								UTM cannot handle such large area (cf. <a href="../gis_lecture3.html#/what_is_utm1" target="_blank">Lec 3</a>)
							</li>
						</ul>
						<p>
							Sinusoidal: often used for the entire world or continents
						</p>
				</section>

				<section id="sinusoida2" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Sinusoidal projection
					</h3>
					<p>
						Assume the Earth is a sphere. Then:
					</p>
					<p>
						Length of 360&deg in latitude: same across all longitudes
					</p>
					<p>
						Length of 360&deg in longitude:
					</p>
					<table border="0" width="100%">
						<tr>
							<td>at latitude 0&deg (equator)</td>
							<td>$\Rightarrow$</td>
							<td>$2\pi$ x Earth's radius</td>
						</tr>
						<tr>
							<td>at latitude $\theta$&deg</td>
							<td>$\Rightarrow$</td>
							<td>$2\pi$ x Earth's radius x $\cos(\theta)$</td>
						</tr>
					</table>
					<p>
					<img src="gis_lecture4/cosine.gif" style="border: none; background: none; box-shadow:none; width: 250px; float: left;">
						<br>
						<br>
						<br>
						<br>
						<small>$\leftarrow$ Earth cross-section cut through North and South Poles</small>
					</p>
				</section>

				<section id="sinusoidal2" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
						Sinusoidal projection (cont.)
					</h4>
					<p>
						Projected coordinate $(x',y')$ is given by:
					</p>
					<p>
						\begin{align*}
						y' & = M_y * y \\
						x' & = M_x * (x - x_0) * \cos(y)
						\end{align*}
					</p>
					<table border="0" width="100%">
						<tr>
							<td style="text-align: center">$M_x, M_y$</td>
							<td>Length of 1 &deg in longitude/latitude on equator (in meters)</td>
						</tr>
						<tr>
							<td style="text-align: center">$y$</td>
							<td>Latitude in geographic coordinate (&deg)</td>
						</tr>
						<tr>
							<td style="text-align: center">$x$</td>
							<td>Longitude in geographic coordinate (&deg)</td>
						</tr>
						<tr>
							<td style="text-align: center">$x_0$</td>
							<td><strong>Central meridian</strong></td>
						</tr>
					</table>
					<p style="text-align: left;">
						Central meridian: affect how map looks, not surface area calculation
					</p>
				</section>

				<section id="sinusoidal3" data-transition="fade-in fade-out" >
					<h4 style="text-align: left;">
						Sinusoidal projection (cont.)
					</h4>
						<p style="text-align: left;">
							Central meridian & all the parallels: straight lines
						</p>
						<p style="text-align: left;">
							Other meridians: sinusoidal curves
						</p>
					<img src="gis_lecture4/sinusoidal.png" style="border: none; background: none; box-shadow:none; width: 800px">
					<p style="text-align: center;">
						<small>(<a href="http://www.absoluteastronomy.com/topics/Map_projection" target="_blank">image source)</a></small>
					</p>
				</section>


				<section id="ex2project" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
					Exercise #2: Step 2
					</h4>
					<h3>
						Project (Data Management)
					</h3>
					<p>
						<strong>Input Dataset or Feature Class</strong>: intersect.shp
					</p>
					<ul style="margin-left: 72px;">
						<li>
							Output from Intersect
						</li>
					</ul>
					<p>
						<strong>Output Dataset or Feature Class</strong>: <code>...\temporary\intersect_sinusoidal.shp</code>
					</p>
					<p>
						<strong>Output Coordinate System</strong>: Africa_Sinusoidal
					</p>
					<ul style="margin-left: 72px;">
						<li>
							Projected Coordinate System > Continental > Africa
						</li>
						<li>
							Notice: central meridian is set at 15&degE (middle of Africa)
						</li>
					</ul>
				</section>

				<section id="ex2addgeo1" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
					Exercise #2: Step 3
					</h4>
					<h3>
						Add Geometry Attributes
					</h3>
					<p>
						This tool can be used for surface area calculation
					</p>
					<p>
						<strong>Input Features</strong>: intersect_sinusoidal.shp
					</p>
					<ul>
						<li>
							The output from Project
						</li>
					</ul>
					<p>
						<strong>Geometry Properties</strong>: check AREA
					</p>
					<p>
						<strong>Area Unit</strong>: SQUARE_KILOMETERS
					</p>
					<ul>
						<li>
							If not specified, it'll be square meters
						</li>
					</ul>
					<p>
						Note: this tool overwrites the input file
					</p>
				</section>

				<section id="ex2addgeo2" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
					Exercise #2: Step 3 (cont.)
					</h4>
					<p>
						Now <em>save and</em> run the Model.
					</p>
					<p>
						Browse the output and its attribute table.
					</p>
					<p>
						Is everything as expected?
					</p>
				</section>

				<section id="ex2addgeo3" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
					An alternative to Exercise #2 Steps 2-3
					</h4>
					<p>
						You can directly use Add Geometry Attributes
					</p>
					<p>
						<strong>Input Features</strong>: intersect.shp
					</p>
					<ul>
						<li>
							The output from Intersect
						</li>
					</ul>
					<p>
						<strong>Geometry Properties</strong>: check AREA_GEODESIC
					</p>
					<p>
						<strong>Area Unit</strong>: SQUARE_KILOMETERS
					</p>
					<p>
						<strong>Coordinate System</strong>: Africa_Sinusoidal
					</p>
					<ul>
						<li>
							If unspecified, the area is calculated based on WGS 1984 (i.e. rubbish)
						</li>
					</ul>
				</section>

				<section id="ex2export1" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
					Exercise #2 Step 4
					</h4>
					<h3>
						Export Attribute Table
					</h3>
					<p>
						Which geo-processing tool(s) should we use?
					</p>
				</section>

				<section id="ex2export2" data-transition="fade-in slide-out" style="text-align: left;">
				<h4>
					Exercise #2 Step 4 (cont.)
				</h4>
				<h3>
					Table To Excel
				</h3>
					<ul>
						<li>
							<strong>Input Table</strong>: intersect_sinusoidal.shp (3)
						</li>
						<li>
							<strong>Output Excel File</strong>: <code>...\output\intersect_sinusoidal.xls</code>
						</li>
					</ul>
				<br>
				<p>
					This time we go with Excel only.
				</p>
					<ul>
						<li>
							Advantage of Export Feature Attribute to ASCII: choose which fields to keep
						</li>
						<li>
							Various country codes to choose from
						</li>
						<li>
							Which one works best with your country data is unknown
						</li>
						<li>
							Better to drop unnecessary variables in Stata
						</li>
					</ul>
					<br>
				</section>

				<section id="model_model2" data-transition="slide-in slide-out" style="text-align: left;">
					<h3>
					"Model" model for Exercise 2
					</h3>
					<p>
						Look at "lecture4\solutions4exercises\models.tbx\exercise2"
					</p>
				</section>
			</section>

			<section>
				<section id="section5">
					<h1>
						5. List in Python
					</h1>
				</section>


				<section id="ex2python1" data-transition="slide-in fade-out" style="text-align: left;">
					<h3>
					Specify multiple input files in Python
					</h3>
					<p>
						Now export a Python script
					</p>
					<p>
						Look at the command line for Intersect
					</p>
					<pre>
						<code data-trim>
# Local variables:
borders_tribes_shp = "C:\\Users\\Masayuki Kudamatsu\\Desktop\\Lecture4\\input\\borders_tribes.shp"
african_countries_shp = "C:\\Users\\Masayuki Kudamatsu\\Desktop\\Lecture4\\input\\african_countries.shp"

# Process: Intersect
arcpy.Intersect_analysis("'C:\\Users\\Masayuki Kudamatsu\\Desktop\\Lecture4\\input\\borders_tribes.shp' #;'C:\\Users\\Masayuki Kudamatsu\\Desktop\\Lecture4\\input\\african_countries.shp' #", intersect_shp, "ALL", "", "INPUT")
						</code>
					</pre>
					<p>
						For geo-processing tools that take multiple inputs, Model Builder fails to use local variables for input file names
					</p>
					<p>
						We ourselves need to use local variables
					</p>
				</section>

				<section id="ex2python2" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
					Specify multiple input files in Python (cont.)
					</h4>
					<p>
					If you write the script as follows:
					</p>
					<p style="margin-left: 50px;">
						<code>
							data1 = "data1.shp"
						</code>
					</p>
					<p style="margin-left: 50px;">
						<code>
							data2 = "data2.shp"
						</code>
					</p>
					<p style="margin-left: 50px;">
						<code>
							<mark>input_list = [data1, data2]</mark>
						</code>
					</p>
					<p style="margin-left: 50px;">
						<code>arcpy.Intersect_analysis(<mark>input_list</mark>, intersect_shp, "ALL", "", "INPUT")</code>
					</p>
					<p>
						$\Rightarrow$ Python recognises 1st argument as
					</p>
					<p style="text-align: center;">
					<code>
						 ["data1.shp","data2.shp"]
					</code>
					</p>
				</section>

				<section id="python101datatype" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
						Python 101
					</h4>
					<h3>
						Data type
					</h3>
						<p>
							In Python, a variable can take several data types
						</p>
						<ul>
							<li>
								<code>number = 4</code>
							</li>
							<li>
								<code>string = "python"</code>
							</li>
							<li>
								<code>list = [4,"python"]</code>
							</li>
							<li>
								<code>dictionary = {"number": 4, "string": "python"}</code> (cf. Lec 8)
							</li>
						</ul>
						<p>
							See <a href="http://www.tutorialspoint.com/python/python_variable_types.htm" target="_blank">TutorialsPoint</a> for more on data type
						</p>
				</section>

				<section id="python101list" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
						Python 101 (cont.)
					</h4>
					<h3>
						List
					</h3>
					<p>
						<code>list = [4,"python"]</code>
					</p>
						<p>
							To define a list, use [ ]
						</p>
						<p>
							Each item is separated by ,
						</p>
						<p>
							Items can either be numbers or strings
						</p>
						<p>
							See <a href="http://www.tutorialspoint.com/python/python_lists.htm" target="_blank">TutorialsPoint</a> for more on list
						</p>
				</section>

				<section id="list4arcgis1a" data-transition="slide-in fade-out" style="text-align: left;">
					<h3>
						When to use Python List for ArcGIS
					</h3>
					<p>
						1. Loop over files (cf. <a href="../gis_lecture3.html#/loop_over_list" target="_blank">Lec 3</a>)
					</p>
					<p>
						2. Specify multiple input file names for a geo-processing tool
					</p>
						<ul>
							<li>
								Intersect
							</li>
							<li>
								Near (for near features)
							</li>
						</ul>
						<p>
							See ArcGIS Online Help to tell whether list can be used
						</p>
				</section>

				<section id="list4arcgis1b" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
						<a href="http://desktop.arcgis.com/en/arcmap/latest/tools/analysis-toolbox/intersect.htm" target="_blank"> ArcGIS Online Help for Intersect</a>
					</h4>
					<img src="gis_lecture4/list4arcgis.png" style="border: none; background: none; box-shadow:none; width: 900px;">
				</section>

				<section id="list4arcgis1c" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
						<a href="http://desktop.arcgis.com/en/arcmap/latest/tools/analysis-toolbox/near.htm" target="_blank"> ArcGIS Online Help for Near</a>
					</h4>
					<img src="gis_lecture4/list4arcgis2near.png" style="border: none; background: none; box-shadow:none; width: 900px;">
				</section>

				<section id="ex2last" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
					Exercise #2 (cont.)
					</h4>
					<h3>
						Edit the exported Python script
					</h3>
					<p>
						1. Use the template (Lecture4\template4L4.py)
					</p>
					<ul style="margin-left: 72px;">
						<li>
							Try-Except statement (<a href="../gis_lecture2.html#/ex6a" target="_blank">Lec 2 Ex 6</a>)
						</li>
						<li>
							String variables for file names (<a href="../gis_lecture2.html#/ex7a" target="_blank">Lec 2 Ex 7</a>)
						</li>
						<li>
							Print commands (<a href="../gis_lecture2.html#/ex8a" target="_blank">Lec 2 Ex 8</a>)
						</li>
					</ul>
					<p>
						2. Replace Intersect's input file names w/ a list
					</p>
					<p>
						3. Close outputs in ArcMap
					</p>
					<p>
						4. Run the script
					</p>
				</section>

				<section id="ex2last2" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
					Exercise #2 (cont.)
					</h4>
					<p>
						The Python script relevant for using the Intersect tool should now look like:
					</p>
					<pre>
						<code data-trim>
# Set the working directory.
arcpy.env.workspace = "C:\\Users\\Masayuki Kudamatsu\\Desktop\\Lecture4" # NEVER USE single backslash (\).

# Local variables:
borders_tribes_shp = "input\\borders_tribes.shp"
african_countries_shp = "input\\african_countries.shp"
intersect_shp = "temporary\\intersect.shp"

# Process: Intersect
inFeatures = [borders_tribes_shp, african_countries_shp]
arcpy.Intersect_analysis(inFeatures, intersect_shp, "ALL", "", "INPUT")
						</code>
					</pre>
				</section>


				<section id="model_script" data-transition="slide-out fade-in" style="text-align: left;">
					<h3>
					Model Python Script for Lecture 4 Exercise 2
					</h3>
					<p>
						Look at <code>solutions4exercises/exercise2.py</code>
					</p>
				</section>
			</section>


				<section id="lessons" style="text-align: left;">
					<h3>
						What we've learned on ArcGIS
					</h3>
					<ol>
						<li>
							Create polygon centroid point features
						</li>
						<li>
							Calculate distance to polyline features
						</li>
						<li>
							Intersect polygons/polylines
						</li>
						<li>
							Calculate surface area of polygons
						</li>
					</ol>
					<p>
						Do you remember which geo-processing tools you used for each of these tasks?
					</p>
				</section>

			</div>
			<!-- To end the reconfiguration of an HTML5 <section> element as a slide using CSS. -->

		</div>
		<!-- To end the activation of the CSS framework of Reveal.js -->

		<!-- Java script commands should be placed at the bottom of an HTML file, to reduce the perceived loading time  -->

		<!-- Load head.js, providing a number of utility classses. http://headjs.com/ -->
		<script src="lib/js/head.min.js"></script>
		<!-- Load reveal.js -->
		<script src="js/reveal.js"></script>

		<!-- Import MathJax, to use TeX for mathematic expressions -->
		<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
		<!-- Allow inline math expressions by using $ -->
		<!-- http://tex.stackexchange.com/questions/27633/mathjax-inline-mode-not-rendering -->
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
		    tex2jax: {
		      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
		      processEscapes: true
		    }
		  });
		</script>

		<script>
			// Set the options for Reveal.js
			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true, // Enable the navigation arrows on bottom right
				progress: true,
				history: true,
				center: true,
				rollingLinks: false, // Disable the default rolling links

				transition: 'slide', // Choose from: none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
