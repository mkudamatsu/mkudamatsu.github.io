<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<!-- For Google search results -->
		<title>ArcGIS for Economics: Lecture x</title>
		<meta name="description" content="ArcGIS for economics researchers">
		<meta name="author" content="Masayuki Kudamatsu">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<!-- Activate Reveal.js -->
		<link rel="stylesheet" href="css/reveal.css">

		<!-- Define the theme -->
		<link rel="stylesheet" href="css/theme/white4me.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/tomorrow.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--Add support for earlier versions of Internet Explorer -->
		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<!-- To activate the CSS framework of Reveal.js -->
		<div class="reveal">

			<!-- To reconfigure an HTML5 <section> element as a slide using CSS. -->
			<div class="slides">

				<!-- Slide contents start here -->

				<!-- My own slide templates -->
				<section id="title">
					<h3 style="color:slategrey">
						Causal Inference with Spatial Data
					</h3>
					<p style="color:slategrey">
 						(ArcGIS 10 for Economics Research)
					</p>
					<h3>
						Lecture 6
					</h3>
					<h2>
						Elevation
					</h2>
					<br>
					<p>Masayuki Kudamatsu</p>
					<p>16 November, 2018</p>
					<br>
					<p>
						<small>Press <span style="color:red;">SPACE</span> to proceed. </small>
						<br>
						<small>To go back to the previous slide, press <span style="color:red;">SHIFT+SPACE</span>. </small>
					</p>
				</section>

				<!-- ROAD MAP -->
				<section id="road_map" style="text-align: left;">
					<h3>
						Today's road map
					</h3>
						<p>
							1. Elevation in economics
						</p>
						<p>
							2. Duflo & Pande (2007)
						</p>
						<p>
							3. Replicate instruments in Duflo & Pande (2007)
						</p>
						<p>
							4. Calculate polyline length
						</p>
						<p>
							5. Loop over values in Python
						</p>
				</section>

			<section>
				<section id="section1">
					<h1>
						1. Elevation in economics
					</h1>
					<p>
						It's a great source of exogenous variation!
					</p>
				</section>

			<section id="" data-transition="slide-in slide-out" style="text-align: left;">
				<h3>
					<a href="http://dx.doi.org/10.1257/aer.101.7.3078" target="_blank">Dinkelman (2011)</a>
				</h3>
					<p>
						Electrification in South Africa (1996-2001)
					</p>
					<p>
						$\Rightarrow$ Female labor supply $\uparrow$
					</p>
					<p class="fragment" data-fragment-index="1">
						Electrification: instrumented by <strong>mean land gradient</strong>
					</p>
					<ul class="fragment" data-fragment-index="1">
						<li>
							Flat terrain: cheap to lay power lines
						</li>
					</ul>
			</section>

			<section id="" data-transition="slide-in slide-out" style="text-align: left;">
				<h3>
					<a href="http://dx.doi.org/10.1162/qjec.2008.123.3.1251" target="_blank">Qian (2008)</a>
				</h3>
					<p>
						Tea production $\uparrow$ in China due to liberalization in 1979
					</p>
					<p>
						$\Rightarrow$ Male-to-female ratio $\downarrow$
					</p>
					<p class="fragment" data-fragment-index="1">
						Tea production: instrumented by <strong>mean land gradient</strong>
					</p>
					<ul class="fragment" data-fragment-index="1">
						<li>
							Tea grows in hilly terrain
						</li>
					</ul>
			</section>

			<!-- <section id="" data-transition="slide-in slide-out" style="text-align: left;">
				<h3>
					<a href="http://dx.doi.org/10.1257/app.1.4.1" target="_blank">Olken (2009)</a>
				</h3>
					<p>
						# of TV channels $\uparrow$ in Indonesia 						$\Rightarrow$ Social capital $\downarrow$
					</p>
					<p>
						TV: instrumented by <strong>signal strength</strong>
					</p>
				<img src="gis_lecture6/olken.png" style="border:none; background:none; box-shadow:none; width:800px;">
			</section> -->

			<section id="" data-transition="slide-in slide-out" style="text-align: left;">
				<h3>
					<a href="http://dx.doi.org/10.1093/qje/qju020" target="_blank">Yanagizawa-Drott (2014)</a>
				</h3>
					<p>
						Anti-Hutu radio station in Rwanda
					</p>
					<p>
						$\Rightarrow$ Genocide incidents $\uparrow$
					</p>
					<p class="fragment" data-fragment-index="1">
						Radio: instrumented by <strong>signal strength</strong>
					</p>
					<img src="gis_lecture6/olken.png" style="border:none; background:none; box-shadow:none; width:800px;"  class="fragment" data-fragment-index="1">
			</section>

			<!-- <section id="" data-transition="slide-in fade-out" style="text-align: left;">
				<h3>
					<a href="http://dx.doi.org/10.1257/app.5.2.200" target="_blank">Lipscomb et al. (2013)</a>
				</h3>
					<p>
						Electricity in Brazil $\Rightarrow$ Poverty $\downarrow$
					</p>
					<p>
						IV for electricity constructed as follows:
					</p>
					<ol>
						<li>
							Regress (probit) hydropower plant on topography measures (incl. <strong>river gradient</strong>) across grid points in Brazil
						</li>
						<li>
							Use fitted values to rank locations by its geographic suitability for hydropower plants
						</li>
						<li>
							Obtain total # of hydropower plants constructed nationwide in each period
						</li>
					</ol>
			</section>
			<section id="" data-transition="fade-in slide-out" style="text-align: left;">
				<h4>
					Lipscomb et al. (2013) (cont.)
				</h4>
					<ol>
						<li value="4">
							If $n$ plants were constructed in period 1, turn on the instrument for the $n$ most suitable locations
						</li>
						<li>
							If $m$ plants were additionally constructed in period 2, turn on the instrument for the next $m$ most suitable locations
						</li>
						<li>
							And so forth...
						</li>
					</ol>
					<p>
						$\Rightarrow$ 1st-stage F-stat: over 20
					</p>
			</section> -->

		</section>

			<section>
				<section id="section2">
					<h1>
						2. <a href="http://dx.doi.org/10.1162/qjec.122.2.601" target="_blank">Duflo & Pande (2007)</a>
					</h1>
				</section>

				<section id="rq1" data-transition="slide-in slide-out" style="text-align: left;">
					<h3>Research Question</h3>
					<p>
						Do irrigation dams improve agricultural production and reduce rural poverty in India?
					</p>
					<p>
						Important?
					</p>
					<ul class="fragment" data-fragment-index="1">
						<li>
							Dams: built on nearly 1/2 of rivers worldwide
						</li>
						<li>
							Believed to reduce poverty, but no credible evidence
						</li>
					</ul>
					<p>
						Original?
					</p>
					<ul class="fragment" data-fragment-index="2">
						<li>
							Use geography to obtain credible impact estimates
						</li>
					</ul>
					<p>
						Feasible?
					</p>
				</section>

				<section id="data1" data-transition="slide-in slide-out" style="text-align: left;">
					<h3>Data</h3>
					<p>
						Unit of analysis: districts
					</p>
					<p>
						Agricultural production data: annual 1971-99
					</p>
					<p>
						Poverty data: 1973, 83, 87, 93, 99
					</p>
					<p class="fragment" data-fragment-index="1">
						Dams: location (nearest city), data of completion
					</p>
					<ul class="fragment" data-fragment-index="1">
						<li>
							Source: World Registry of Large Dams
						</li>
					</ul>
				</section>

				<section id="empirical_strategy1" data-transition="slide-in fade-out" style="text-align: left;">
					<h3>Identification strategy</h3>
					<p>
						Dam constriction: instrumented by river gradient
					</p>
							<p>
								$\Leftarrow$ Dams: easier to build if river gradient is
							<ul style="margin-left: 85px;">
								<li>
									Moderate for irrigation dams
								</li>
								<li>
									Very steep for hydroelectricity dams
								</li>
							</ul>
							</p>
					<p class="fragment" data-fragment-index="1">
						How to use time-invariant river gradient for panel regression?
					</p>
				</section>

				<section id="empirical_strategy2" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						1st stage
					</h3>
					<p>
						\begin{align*}
			D_{ist}
			=& \ \sum_{k=2}^4 \alpha_k (RGr_{ki} \ast \bar{D}_{st})
			+ (\mathbf{M}'_i \ast \bar{D}_{st})\boldsymbol{\beta} \\
			 & + \sum_{k=2}^4 \gamma_k (RGr_{ki} \ast l_{t}) + \nu_i + \mu_{st} + \omega_{ist}
						\end{align*}
					</p>
					<table border="0" width="100%">
						<tr>
							<td style="text-align: center">$D_{ist}$</td>
							<td># dams in district $i$ state $s$ in year $t$</td>
						</tr>
						<tr>
							<td style="text-align: center">$RGr_{ki}$</td>
							<td>Fraction of river areas in gradient category $k$</td>
						</tr>
						<tr>
							<td style="text-align: center"></td>
							<td>(2 for 1.5-3%; 3 for 3-6%, 4 for over 6%)</td>
						</tr>
					</table>
					<p class="fragment"  data-fragment-index="1" style="color:slategrey">
						We will learn how to calculate $RGr_{ki}$ in ArcGIS
					</p>
				</section>

				<section id="empirical_strategy3" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
						1st stage (cont.)
					</h4>
					<p>
						\begin{align*}
			D_{ist}
			=& \ \sum_{k=2}^4 \alpha_k (RGr_{ki} \ast \bar{D}_{st})
			+ (\mathbf{M}'_i \ast \bar{D}_{st})\boldsymbol{\beta} \\
			 & + \sum_{k=2}^4 \gamma_k (RGr_{ki} \ast l_{t}) + \nu_i + \mu_{st} + \omega_{ist}
						\end{align*}
					</p>
					<table border="0" width="100%">
						<tr>
							<td style="text-align: center">$\bar{D}_{st}$</td>
							<td>Predicted # of dams in state $s$ in year $t$<br>
								$=\frac{D_{s,1970}}{\sum_s D_{s,1970}}*\sum_s D_{st}$ <br><span style="color:slategrey">($D_{st}$: # dams in state $s$ in year $t$)</span></td>
						</tr>
						<tr class="fragment"  data-fragment-index="2">
							<td style="text-align: center"></td>
							<td>$\Leftarrow$ $D_{st}$ is endogenous to poverty</td>
						</tr>
					</table>
				</section>

				<section id="empirical_strategy4" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
						1st stage (cont.)
					</h4>
					<p>
						\begin{align*}
			D_{ist}
			=& \ \sum_{k=2}^4 \alpha_k (RGr_{ki} \ast \bar{D}_{st})
			+ (\mathbf{M}'_i \ast \bar{D}_{st})\boldsymbol{\beta} \\
			 & + \sum_{k=2}^4 \gamma_k (RGr_{ki} \ast l_{t}) + \nu_i + \mu_{st} + \omega_{ist}
						\end{align*}
					</p>
					<table border="0" width="100%">
						<tr>
							<td style="text-align: center">$\mathbf{M}_i$</td>
							<td>Controls: river length, fraction of district areas with each gradient cateogry, etc.</td>
						</tr>
						<tr>
							<td style="text-align: center">$l_{t}$</td>
							<td>Year dummies</td>
						</tr>
						<tr>
							<td style="text-align: center">$\nu_i,\mu_{st}$</td>
							<td>District and state-year FEs</td>
						</tr>
					</table>
					<p>
						Why should we control for each of these variables?
					</p>
				</section>

				<section id="empirical_strategy5" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
						1st stage (cont.)
					</h4>
					<p>
						\begin{align*}
			D_{ist}
			=& \ \sum_{k=2}^4 \alpha_k (RGr_{ki} \ast \bar{D}_{st})
			+ (\mathbf{M}'_i \ast \bar{D}_{st})\boldsymbol{\beta} \\
			 & + \sum_{k=2}^4 \gamma_k (RGr_{ki} \ast l_{t}) + \nu_i + \mu_{st} + \omega_{ist}
						\end{align*}
					</p>
					<table border="0" width="100%">
						<tr>
							<td style="text-align: center">$\mathbf{M}_i$</td>
							<td>Controls: <span style="color:firebrick">river length</span>, fraction of district areas with each gradient cateogry, etc.</td>
						</tr>
						<tr>
							<td style="text-align: center">$l_{t}$</td>
							<td>Year dummies</td>
						</tr>
						<tr>
							<td style="text-align: center">$\nu_i,\mu_{st}$</td>
							<td>District and state-year FEs</td>
						</tr>
					</table>
					<p style="color:firebrick">
						We will learn how to obtain river length in $\mathbf{M}_i$
					</p>
				</section>

				<section id="empirical_strategy5" data-transition="slide-in fade-out" style="text-align: left;">
					<h3>
						2nd stage
					</h3>
					<p>
						\begin{align*}
			y_{ist} =& \ \gamma_i + \eta_{st} + \delta D_{ist} + \delta^U D_{ist}^U \\
			         & + \mathbf{Z}_{ist}\mathbf{\delta_Z} + \mathbf{Z^U}_{ist}\mathbf{\delta_Z^U} + \varepsilon_{ist}
						\end{align*}
					</p>
					<table border="0" width="100%">
						<tr>
							<td style="text-align: center">$y_{ist}$</td>
							<td>Agricultural outcomes / poverty measures</td>
						</tr>
						<tr class="fragment" data-fragment-index="1">
							<td style="text-align: center">$D_{ist}$</td>
							<td># of dams in own district <span class="fragment" data-fragment-index="4">(harmful)</span></td>
						</tr>
						<tr>
							<td style="text-align: center"></td>
							<td  class="fragment" data-fragment-index="4">$\Leftarrow$ Displacement, soil degradation, restricted water use</td>
						</tr>
						<tr class="fragment" data-fragment-index="2">
							<td style="text-align: center">$D_{ist}^U$</td>
							<td># of dams in upstream districts <span class="fragment" data-fragment-index="3">(beneficial)</span></td>
						</tr>
						<tr>
							<td style="text-align: center"></td>
							<td class="fragment" data-fragment-index="3">$\Leftarrow$ Irrigation</td>
						</tr>
						<tr class="fragment" data-fragment-index="5">
							<td style="text-align: center">$\mathbf{Z}_{ist}$</td>
							<td>All the controls for own district</td>
						</tr>
						<tr class="fragment" data-fragment-index="5">
							<td style="text-align: center">$\mathbf{Z^U}_{ist}$</td>
							<td>All the controls for upstream districts</td>
						</tr>
					</table>
				</section>

				<section id="empirical_strategy6" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
						2nd stage (cont.)
					</h4>
					<p>
						\begin{align*}
			y_{ist} =& \ \gamma_i + \eta_{st} + \delta D_{ist} + \delta^U D_{ist}^U \\
			         & + \mathbf{Z}_{ist}\mathbf{\delta_Z} + \mathbf{Z^U}_{ist}\mathbf{\delta_Z^U} + \varepsilon_{ist}
						\end{align*}
					</p>
					<p>
						$D_{ist}$: instrumented by fitted value from 1st stage
					</p>
					<p>
					 	$D_{ist}^U$: instrumented by sum of fitted values from 1st stage for upstream districts
					</p>
				</section>

				<section id="result1"  data-transition="slide-in slide-out">
					<h4>
						1st stage results
					</h4>
					<img src="gis_lecture6/damsT2.png" style="border: none; background: none; box-shadow:none; width: 600px;">
					<p>
						<small>(Table II of Duflo and Pande 2007)</small>
					</p>
				</section>

				<section id="result2a"  data-transition="slide-in fade-out">
					<h4>
						2nd stage results (on agriculture)
					</h4>
					<img src="gis_lecture6/damsT3a.png" style="border: none; background: none; box-shadow:none; width: 700px;">
					<p>
						<small>(Table III of Duflo and Pande 2007)</small>
					</p>
				</section>
				<section id="result2b"  data-transition="fade-in fade-out">
					<h4>
						2nd stage results (on agriculture)
					</h4>
					<img src="gis_lecture6/damsT3b.png" style="border: none; background: none; box-shadow:none; width: 700px;">
					<p>
						<small>(Table III of Duflo and Pande 2007)</small>
					</p>
				</section>
				<section id="result2c"  data-transition="fade-in slide-out">
					<h4>
						2nd stage results (on poverty)
					</h4>
					<img src="gis_lecture6/damsT8.png" style="border: none; background: none; box-shadow:none; width: 700px;">
					<p>
						<small>(Table VIII of Duflo and Pande 2007)</small>
					</p>
				</section>



			</section>


				<!-- Preparation -->
			<section>
				<section id="preparation1" data-transition="slide-in fade-out" style="text-align: left;">
					<h3>
						Prepare for the rest of this lecture
					</h3>
					<p>
						1. Launch ArcMap 10 (it takes time)
					</p>
					<p>
						2. <a href="https://www.dropbox.com/s/3didb10i3opzlbn/Lecture6.zip?dl=1" target="_blank">Download the zipped dataset for Lecture 6</a>
					</p>
					<p>
						3. Save it to <strong>Desktop</strong> (<code>C:\\Users\\<em>yourname</em>\\Desktop</code>)
					</p>
					<p>
						4. Right-click it and choose <span style="background-color: Gainsboro">7-Zip > Extract to "Lecture6\"</span>
					</p>
					<ul style="margin-left: 72px;">
						<li>
							 So the directory path will be: <code>C:\\Users\\<em>yourname</em>\\Desktop\\Lecture6</code>
						</li>
					</ul>
					<p>
						In the <code>input</code> folder:
					</p>
					<p>
						5. Right-click <code>10m-rivers-lake-centerlines.zip</code> and select <span style="background-color: Gainsboro">7-Zip > Extract to Here</span>
					</p>
				</section>

				<section id="preparation2" data-transition="slide-out fade-in" style="text-align: left;">
					<h4>
						Prepare for the rest of this lecture (cont.)
					</h4>
					<p>
						Now in ArcMap's <strong>Catalogue Window</strong>:
					</p>
					<p>
						6. Establish connection to data folder
					</p>
					<ul style="margin-left: 72px;">
						<li style="margin-bottom: 5px;">
							Right-click <span style="background-color: Gainsboro">Folder Connections</span>
						</li>
						<li style="margin-bottom: 5px;">
							Select <span style="background-color: Gainsboro">Connect to Folder</span>
						</li>
						<li>
							Choose <span style="background-color: Gainsboro">Desktop > Lecture6</span>
						</li>
					</ul>
					<p>
						7. Create two empty models in the <code>code/models.tbx</code>
					</p>
					<ul style="margin-left: 72px;">
							<li>
								<code>exercises1-3</code>
							</li>
							<li>
								<code>exercise4</code>
							</li>
					</ul>
				</section>

			<section id="elevation-data1" data-transition="slide-in fade-out" style="text-align: left;">
				<h4>
					Elevation data
				</h4>
				<p>
					We use SRTM30 (version 2.1)
				</p>
				<ul>
					<li>
						It supersedes GTOPO30 used by Duflo and Pande (2007)
					</li>
					<li>
						<a href="http://www.geo-airbusds.com/worlddem/" target="_blank">WorldDEM</a> is an updated version, but not for free of charge
					</li>
				</ul>
				<p>
					Resolution: 30x30 arc seconds (roughly 1x1km)
				</p>
				<p>
					Avaialable in 27 separate tiles
				</p>
				<img src="gis_lecture6/srtm30tiles.png" style="border:none; background:none; box-shadow:none; width:400px;">
			</section>

			<section id="elevation-data2" data-transition="fade-in fade-out" style="text-align: left;">
				<h4>
					How to use SRTM30 in ArcGIS 10
				</h4>
				<p>
					1. Log on to: <a href="http://www.webgis.com/srtm30.html" target="_blank">webgis.com/srtm30.html</a>
				</p>
				<p>
					2. Click the tile covering your study area
				</p>
				<p>
					3. Download:
				</p>
				<ul>
					<li>
						<code>***.dem.zip</code> (data file)
					</li>
					<li>
						<code>***.hdr.zip</code> (header file)
					</li>
					<li>
						<code>***.prj.zip</code> (projection file)
					</li>
					<li>
						<code>***.stx.zip</code> (statistics file)
					</li>
				</ul>
				<p>
					For this lecture, these four files for India (<code>060n40.***.zip</code>) are already downloaded <br>in the <code>input/</code> folder.
				</p>
			</section>

			<section id="elevation-data3" data-transition="fade-in fade-out" style="text-align: left;">
				<h4>
					How to use SRTM30 in ArcGIS 10 (cont.)
				</h4>
				<p>
					4. Unzip them so the four files (.DEM, .HDR, .PRJ, .STX) are all saved in the same directory
				</p>
				<ul>
					<li>
						Right-click each .zip file and choose <span style="background-color: Gainsboro">7-Zip > Extract Here</span>
					</li>
				</ul>
				<p>
					5. Drag the .DEM file from ArcMap's Calatogue window
				</p>
				<p>
					6. For geo-processing, use the .DEM file as the input file
				</p>
				<p>
					7. If you use multiple tiles, <strong><a href="http://desktop.arcgis.com/en/arcmap/10.3/tools/data-management-toolbox/mosaic-to-new-raster.htm" target="_blank">Mosaic to New Raster</a></strong> appends them all
				</p>
			</section>

			<section id="mosaic-to-new-raster" data-transition="fade-in slide-out" style="text-align: left;">
				<h4>
					<a href="http://desktop.arcgis.com/en/arcmap/latest/tools/data-management-toolbox/mosaic-to-new-raster.htm" target="_blank">Mosaic to New Raster</a>
				</h4>
				<p>
					Make sure to set the appropriate <strong>pixel type</strong>
				</p>
				<ul>
					<li>
						By default, it sets <code>8_BIT_UNSIGNED</code> (i.e. 0 to 255)
					</li>
					<li>
						If your raster data is in decimals, negative values, or larger than 255, it gets distorted
					</li>
					<li>
						For elevation data, choose <code>16_BIT_SIGNED</code> (i.e. -32,768 to 32,767)
					</li>
				</ul>
			</section>

		</section>

			<!-- SECTION for ArcMap -->
			<section>
				<section id="section3">
					<h1>
						3. Replicate Instruments in Duflo & Pande (2007)
					</h1>
				</section>

				<section id="data2construct1" data-transition="slide-in fade-out" style="text-align: left;">
					<h3>
						Data we want to construct
					</h3>
						<p>
							District-level data on fraction of river areas with gradient:
						</p>
						<ul>
							<li>
								1.5-3%
							</li>
							<li>
								3-6%
							</li>
							<li>
								6% or steeper
							</li>
						</ul>
						<div class="fragment" data-fragment-index="1">
							<p>
								$\Rightarrow$ Obtain gradient of each segment of river by matching river polylines with gradient raster:
							</p>
							<img src="gis_lecture6/river_on_grid.jpg"ã€€style="border: none; background: none; box-shadow:none; width: 400px; float: left ;">
 						</div>

				</section>


				<section id="data2construct2" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
						Data we want to construct (cont.)
					</h4>
					<p>
						If each raster cell is not of equal size within a district
					</p>
					<ul>
						<li>
							Each cell is large
						</li>
						<li>
							The district stretches a lot along the north-south direction
						</li>
					</ul>
					<p class="fragment" data-fragment-index="1">
					  $\Rightarrow$ Need to project the raster data <span style="color:slategrey">(cf. Lecture 7)</span>
					<p>
				</section>

				<section id="data2construct3" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
						Data we want to construct (cont.)
					</h4>
					<p>
						But this lecture assumes:
					</p>
					<p>
						Each river segment is <strong>of equal size</strong> within the same district
					</p>
					<ul class="fragment" data-fragment-index="1">
						<li>
							Districts in India are at most 3&deg wide in latitude
						</li>
						<ul class="fragment" data-fragment-index="2">
							<li>
								India is located from 8&deg to 37&deg North
							</li>
							<li class="fragment" data-fragment-index="3">
								1&deg in longitude at 15&deg = 107.551km
							</li>
							<li class="fragment" data-fragment-index="4">
								1&deg in longitude at 30&deg = 96.486km
							</li>
						</ul>
					<li class="fragment" data-fragment-index="5">
						30 seconds in longitude can differ up to <strong>only 18m</strong>
					</li>
					</ul>
					<p  class="fragment" data-fragment-index="6" style="text-align: center;">
					$\frac{107551-96486}{120}*\frac{3}{30-15} \approx 18$
					<p>
				</section>

				<!-- Standard text slide -->
				<section id="data2construct4" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
						Data we want to construct (cont.)
					</h4>
					<p>
						If each river segment is of equal size,
					</p>
					<p>
						$\Rightarrow$ We can use Zonal Statitics <span style="color:slategrey">(cf. Lecture 5)</span> with two inputs:
					</p>
					<ol style="margin-left: 85px;">
						<li>
							River polylines
						</li>
						<li>
							Indicator raster for each gradient category
						</li>
						<ul>
						<li>
							1 for (say) 3-6%
						</li>
						<li>
							0 otherwise
						</li>
						</ul>
					</ol>
					<br>
					<table style="margin-top: 50px;">
						<tr class="fragment" data-fragment-index="1">
							<td style="text-align: center; border: 1px solid black;">Mean cell value among river cells</td>
							<td style="text-align: center;">=</td>
							<td style="text-align: center; border: 1px solid black;">Fraction of river areas with gradient 3-6%</td>
						</tr>
						<tr class="fragment" data-fragment-index="2">
							<td style="text-align: center">
								$\uparrow$
							</td>
							<td></td>
							<td></td>
						</tr>
						<tr class="fragment" data-fragment-index="2">
							<td style="text-align: center">
								Zonal Statistics
							</td>
							<td></td>
							<td></td>
						</tr>
					</table>
				</section>


				<section id="data2construct5" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
						Data we want to construct (cont.)
					</h4>
						<p>
							1. Indicator raster for each gradient category
						</p>
						<ul>
							<li>
								1.5-3%
							</li>
							<li>
								3-6%
							</li>
							<li>
								6% or steeper
							</li>
						</ul>
						<p>
							2. River polylines intersected & dissolved by district
						</p>
						<p class="fragment" data-fragment-index="1">
							3. % of river segments in each gradient category
						</p>
						<ul class="fragment" data-fragment-index="1">
						  <li>
								Use Zonal Statistics with 1 and 2 as inputs
							</li>
						</ul>
				</section>

				<section id="ex1a" data-transition="slide-in slide-out" style="text-align: left;">
					<h4>
					Exercise #1: Overview
					</h4>
					<h3>
						Indicator raster for each gradient category
					</h3>
					<p>
						Input: elevation data (<code>E060N40.DEM</code>)
					</p>
					<p>
						Geo-processing tools:
					</p>
					<p>
						1. Slope
					</p>
						<ul style="margin-left: 72px;">
							<li>
								Transform elevation to gradient
							</li>
						</ul>
					<p>
						2. Reclassify (Spatial Analyst)
					</p>
						<ul style="margin-left: 72px;">
							<li>
								Create indicator raster cells
							</li>
						</ul>
				</section>

				<section id="" data-transition="slide-in fade-out" style="text-align: left;">
					<h3>
						What Slope tool does
					</h3>
					<p>
						Return either $\theta$ or $\tan\theta$ in diagram below
					</p>
					<p>
					<img src="gis_lecture6/slope.gif" style="border: none; background: none; box-shadow:none; width: 800px;">
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
						What Slope tool does (cont.)
					</h4>
					<p>
						<img src="gis_lecture6/cells.gif" style="border: none; background: none; box-shadow:none; width: 200px; float: right;">

					</p>
					<p>
						$\tan\theta$ for cell $e$ is obtained by
					</p>
					<p>
						\begin{align*}
							\Rightarrow \ \tan \theta = \sqrt{(dz/dx)^2+(dz/dy)^2}
						\end{align*}
					</p>
					<p>
						where
					</p>
					<p>
						\begin{align*}
						\frac{dz}{dx} = & \ \Big[\frac{c + 2f + i}{4} - \frac{a+2d+g}{4}\Big] / 2 \\
						\frac{dz}{dy} = & \ \Big[\frac{a+2b+c}{4} - \frac{g + 2h + i}{4}\Big] / 2
						\end{align*}
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
					Exercise #1: Step 1
					</h4>
					<h3>
						SLOPE
					</h3>
					<p>
						<strong>Input raster</strong>: <code>...\Lecture6\input\E060N40.DEM</code>
					</p>
					<p>
						<strong>Output raster</strong>: <code>...\Lecture6\temporary\slope.tif</code>
					</p>
					<p>
						<strong>Output Measurement</strong>: PERCENT_RISE
					</p>
					<ul>
						<li>
							Duflo & Pande (2007) use gradient in % (i.e. $\tan\theta\times 100$)
						</li>
						<li>
							If you need $\theta$, choose DEGREE instead
						</li>
					</ul>
					<p>
						<strong>Z factor</strong>: 0.000009
					</p>
					<ul>
						<li>
							# of (x,y) units in one z unit
						</li>
						<li>
							0.000009&deg = 1m
						</li>
					</ul>
				</section>

				<section id="" data-transition="fade-in slide-out" style="text-align: left;">
					<h3>
						Z-factor
					</h3>
					<p>
						<strong>1</strong> if raster data is in projected coordinate system
					</p>
					<ul>
						<li>
							If coordinates and elevation are in different units (e.g., feet vs meters), use appropriate conversion factor
						</li>
					</ul>
					<p>
						<strong>0.000009</strong> if geographic coordinate system and low-latitude areas
					</p>
					<ul>
						<li>
							1&deg $\approx$ 111,120 meters
						</li>
					</ul>
					<p>
						For middle- to high-latitude areas, use Project Raster first to use UTM projections <span style="color:slategrey">(cf. Lecture 7)</span>
					</p>
					<ul>
						<li>
							1&deg in longitude < 1&deg in latitude
						</li>
					</ul>
				</section>

				<section id="reclassify1" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
					Exercise #1: Step 2
					</h4>
					<h3>
						RECLASSIFY
					</h3>
					<p>
						<strong>Input raster</strong>: slope.tif
					</p>
					<ul>
						<li>
							Output from Slope tool
						</li>
					</ul>
					<p>
						<strong>Reclass field</strong>: VALUE
					</p>
					<p>
						<strong>Reclassification</strong>: see next slide
					</p>
					<p>
						<strong>Output raster</strong>: <code>...\Lecture6\temporary\gradient3060.tif</code>
					</p>
					<p>
						Uncheck "<strong>Change missing values to NoData</strong>"
					</p>
				</section>

				<section id="reclassify2" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
						RECLASSIFY (cont.)
					</h4>
					<p>
						For gradient 3-6%:
					</p>
					<p>
						<img src="gis_lecture6/reclassify2.png" style="border: none; background: none; box-shadow:none; width: 600px;">
					</p>
					<ul>
						<li>
							Select rows other than NoData; then click "Delete Entries"
						</li>
						<li>
							Click "Add Entry"; then click each cell to enter values
						</li>
						<li>
							For a range of values, enter <span style="color:red;">spaces</span> before/after hyphen
						</li>
						<li>
							For max value, browse input raster (slope.tif) in ArcMap
						</li>
						<li>
							Use comma (,) for decimal marks if you live in one of <a href="https://en.wikipedia.org/wiki/Decimal_mark#Countries_using_Arabic_numerals_with_decimal_comma" target="_blank">these countries</a>.
						</li>
					</ul>
				</section>

				<!-- Standard text slide -->
				<section id="" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
						Exercise #1 Step 2 (cont.)
					</h4>
						<p>
							Repeat for gradient 1.5-3% and over 6%
						</p>
				</section>

				<section id="ex2a" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
					Exercise #2: Overview
					</h4>
					<h3>
						River polylines by district
					</h3>
					<p>
						Inputs:
					</p>
					<p>
						Natural Earth 1:10m river + lake centerlines (<code>ne_10m_river_lake_centerlines.shp</code>)
					</p>
					<ul>
						<li>
							Digital Charts of the World, used by Duflo & Pande (2007), was made in 1992
						</li>
						<li>
							Natural Earth: updated alternative
						</li>
					</ul>
					<p>
						Indian district polygons (<code>gadm36_IND_2.shp</code>)
					</p>
					<ul>
						<li>
							Provided by GADM
						</li>
					</ul>
				</section>

				<section id="ex2b" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
					Exercise #2: Overview (cont.)
					</h4>
					<p>
						Geo-processing tools:
					</p>
					<p>
						1. Intersect
					</p>
						<ul style="margin-left: 72px;">
							<li>
								Cut rivers by district boundaries
							</li>
						</ul>
					<p>
						2. Dissolve
					</p>
						<ul style="margin-left: 72px;">
							<li>
								Turn all river polylines within a district into one feature
							</li>
						</ul>
					<p>
						cf. <a href="./gis_lecture5.html#intersect_dissolve1" target="_blank">Lecture 5</a>
					</p>
				</section>

				<section id="ex2intersect" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
					Exercise #2: Step 1
					</h4>
					<h3>
						Intersect (Analysis)
					</h3>
					<p>
						<strong>Input Features</strong> (both in <code>...\Lecture6\input\</code>):
					</p>
					<p>
						<code>gadm36_IND_2.shp</code>
					</p>
					<p>
						<code>ne_10m_rivers_lake_centerlines.shp</code>
					</p>
					<ul>
						<li>
							Click the <span style="color:red;">directory icon</span> to choose input data
						</li>
						<li>
							If the data is shown in ArcMap, it appears in the drop-down menu. But then the data file name won't properly be exported in a Python script.
						</li>
					</ul>
					<p>
						<strong>Output Feature Class</strong>: <code>...\Lecture6\temporary\intersect.shp</code>
					</p>
				</section>

				<section id="ex2dissolve" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
					Exercise #2: Step 2
					</h4>
					<h3>
						Dissolve (Data Management)
					</h3>
					<p>
						<strong>Input Features</strong>: intersect.shp
					</p>
					<ul>
						<li>
							Output from Intersect
						</li>
					</ul>
					<p>
						<strong>Output Feature Class</strong>: <code>...\output\river_by_district.shp</code>
					</p>
					<ul>
						<li>
							We will use this data for Exercise #3
						</li>
					</ul>
					<p>
						<strong>Dissolve_Field(s)</strong>: GID_2
					</p>
					<ul>
						<li>
							Unique district ID
						</li>
					</ul>
					<p>
						Check "<strong>Create multipart features</strong>"
					</p>
				</section>

				<section id="ex2dissolve2" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
						Dissolve (Data Management) (cont.)
					</h4>
					<p>
						<strong>Statistics Field(s)</strong>
					</p>
					<p>
						NAME_1 FIRST
					</p>
					<p>
						NAME_2 FIRST
					</p>
					<ul>
						<li>
							To keep state and district names
						</li>
						<li>
							Choose FIRST (or LAST) for string fields
						</li>
					</ul>
				</section>


				<section id="validate1" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
					Exercise #2 (cont.)
					</h4>
					<p>
						Now <em>save and</em> run the Model.
					</p>
					<p>
						Browse <code>river_by_district.shp</code>
					</p>
					<p>
						To check if multipart features are properly created:
					</p>
					<ul>
						<li>
							Browse <code>river_by_disrict.shp</code> and <code>gadm36_IND_2.shp</code>
						</li>
						<li>
							Select a district with multiple rivers by cursor
						</li>
						<li>
							See attribute table of <code>gadm36_IND_2.shp</code> for GID_2 of the selected district
						</li>
						<li>
							See attribute table of <code>river_by_disrict.shp</code> and select the row for this GID_2
						</li>
					</ul>
				</section>

				<section id="ex3" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
					Exercise #3
					</h4>
					<h3>
						Fraction of river areas with each gradient category
					</h3>
					<p>
						Geo-processing tools:
					</p>
					<p>
						1. Zonal Statistics as Table
					</p>
					<p>
						2. Table To Excel
					</p>
				</section>

				<section id="zonal_stat1" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
					Exercise #3: Step 1
					</h4>
					<h3>
						Zonal Statistics as Table
					</h3>
					<p>
						<strong>Input raster or feature zone data</strong>: river_by_district.shp
					</p>
					<ul>
						<li>
							Output from Dissolve
						</li>
					</ul>
					<p>
						<strong>Zone field</strong>: GID_2
					</p>
					<p>
						<strong>Input value raster</strong>: gradient3060.tif
					</p>
					<ul>
						<li>
							Output from Reclassify
						</li>
					</ul>
					<p>
						<strong>Output Table</strong>: <code>...\temporary\river_gradient3060.dbf</code>
					</p>
					<p>
						Check "<strong>Ignore NoData in calculation</strong>"
					</p>
					<p>
						<strong>Statistics type</strong>: MEAN
					</p>
				</section>

				<section id="table2excel" data-transition="fade-in fade-out" style="text-align: left;">
				<h4>
					Exercise #3 Step 2
				</h4>
				<h3>
					Table To Excel
				</h3>
						<p>
							<strong>Input Table</strong>: river_gradient3060.dbf
						</p>
						<p>
							<strong>Output Excel File</strong>: <code>...\Lecture6\output\river_gradient3060.xls</code>
						</p>
				</section>

				<!-- Standard text slide -->
				<section id="" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
						Exercise #3 (cont.)
					</h4>
						<p>
							Repeat for gradient 1.5-3% and over 6%
						</p>
				</section>


				<section id="model_script1" data-transition="slide-out slide-in" style="text-align: left;">
					<h3>
					Solutions for Exercises 1-3
					</h3>
					<p>
						Look at
					</p>
					<ul>
						<li><code>models.tbx\exercises1-3</code></li>
						<li><code>exercises1-3.py</code></li>
					</ul>
					<p>
						in the <code>solutions4exercises/</code> folder
					</p>
				</section>

				<!-- Standard text slide -->
				<section id="saiz2010" data-transition="slide-in slide-out" style="text-align: left;">
					<h4>
						Application of Slope + Reclassify + Zonal Statistics
					</h4>
					<h3>
						<a href="http://dx.doi.org/10.1162/qjec.2010.125.3.1253" target="_blank">Saiz (2010)</a>
					</h3>
						<p>
							Use % of areas with slope > 15% as a measure of unsuitability for urban development
						</p>
						<p>
							Finds housing supply inelastic in such areas
						</p>
						<p class="fragment" data-fragment-index="1">
							Slope of over 15%: now often used as IV for housing supply or urban development
						</p>
						<ul class="fragment" data-fragment-index="2">
							<li>
								<a href="http://dx.doi.org/10.1257/aer.20131706" target="_blank">Diamond (2016)</a>, <a href="http://real.wharton.upenn.edu/~harari/Harari_Papers/CityShapeOct2017.pdf" target="_blank">Hariri (2017)</a>, <a href="http://dx.doi.org/10.1016/j.jdeveco.2016.08.005" target="_blank">Chen & Kung (2016)</a>
							</li>
						</ul>
				</section>


				<section id="assignment1" data-transition="slide-in slide-out" style="text-align: left;">
					<h4>
					Assignment #1
					</h4>
					<h3>
						Fraction of <span style="color:red;">district</span> areas in
					</h3>
					<p>
						Gradient 1.5-3%
					</p>
					<p>
						Gradient 3-6%
					</p>
					<p>
						Gradient over 6%
					</p>
					<p>
						Elevation 250-500m
					</p>
					<p>
						Elevation 500-1000m
					</p>
					<p>
						Elevation over 1000m
					</p>
					<ul>
						<li>
						Important to control for, so instruments won't pick up the direct impact of slope/elevation on poverty
						</li>
					</ul>
				</section>
			</section>

			<section>
				<section id="section4">
					<h1>
						4. Calculate polyline length
					</h1>
				</section>

				<section id="" data-transition="slide-in slide-out" style="text-align: left;">
					<h3>
						Coordinate system for polyline length
					</h3>
					<p>
						Cannot use geographic coordinate systems
					</p>
					<p>
						For small areas, use UTM (<a href="../gis_lecture3.html#/section4" target="_blank">Lecture 3</a>)
					</p>
					<p>
						For large areas such as India:
					</p>
					<p style="margin-left: 20px;">
						No single map projection preserves distance in every direction
					</p>
					<p style="margin-left: 20px;" class="fragment" data-fragment-index="1">
							$\Rightarrow$ Project each district to appropriate UTM projection
						</p>
						<p style="margin-left: 20px;" class="fragment" data-fragment-index="2">
							$\Rightarrow$ Loop over UTM zone numbers
						</p>
				</section>

				<section id="india_utm" data-transition="slide-in slide-out" style="text-align: left;">
					<h4>
						India with UTM Zones
					</h4>
					<img src="gis_lecture6/india.png" style="border: none; background: none; box-shadow:none; width: 700px;">
				</section>

				<section id="ex4overview" data-transition="slide-in slide-out" style="text-align: left;">
					<h4>Exercise #4</h4>
					<h3>
						Calculate river length by district
					</h3>
					<p>
						1. Assign UTM zone number to each river-by-district
					</p>
					<p>
						2. Extract rivers whose centroid is within each UTM zone
					</p>
					<p>
						3. Project to UTM
					</p>
					<p>
						4. Calculate river length by district
					</p>
					<p>
						5. Loop over steps 2-4 for all UTM zone numbers
					</p>
					<p class="fragment" data-fragment-index="1">
						$\Rightarrow$ Use Model Builder first, then edit the exported Python script to create a loop.
					</p>
				</section>

				<section id="ex4step1" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
					Exercise #4.1: Overview
					</h4>
					<h3>
						Assign UTM zone number
					</h3>
					<p>
						Inputs:
					</p>
					<p>
						<code>river_by_district.shp</code> (created in Exercise #2)
					</p>
					<p>
						<code>utm.shp</code>: UTM zone polygons, provided by ArcGIS
					</p>
					<ul>
						<li style="margin-bottom: 5px;">
							The file is located in <span style="background-color: Gainsboro">C:\Program Files (x86)\ArcGIS\Desktop10.6\Reference Systems</span>
						</li>
						<li style="margin-bottom: 5px;">
							The version number may differ from <span style="background-color: Gainsboro">10.6</span>
						</li>
						<li>
							Right-click <span style="background-color: Gainsboro">Folder Connections</span> to access to this directory
						</li>
					</ul>
				</section>


				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
					Exercise #4.1: Overview (cont.)
					</h4>
					<p>
						Geo-processing tools:
					</p>
					<p>
						1. Feature To Point (cf. <a href="../gis_lecture4.html#ex1centroids" target="_blank">Lecture 4</a>)
					</p>
					<ul>
						<li>
							Some rivers may cross UTM zone boundaries
						</li>
						<li>
							Assign UTM zone number based on centroid
						</li>
					</ul>
					<p>
						2. Spatial Join
					</p>
					<ul>
						<li>
							Match river centroids with UTM zone polygons
						</li>
					</ul>
					<p>
						3. Copy Features + Join Field
					</p>
					<ul>
						<li>
							Transfer UTM zone number in centroid table to river table
						</li>
						<li>
							Join Field overwrites the input
						</li>
						<li>
							So copy river features first
						</li>
					</ul>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
					Exercise #4.1: Overview (cont.)
					</h4>
					<p>
						There is a tool called "<a href="http://desktop.arcgis.com/en/arcmap/latest/tools/cartography-toolbox/calculate-utm-zone.htm" target="_blank">Calculate UTM Zone</a>"
					</p>
					<p>
						But it's not useful at all.
					</p>
					<ul>
						<li>
							It creates a new field that contains the full string of the coordinate system, which may be truncated...
						</li>
						<li>
							Why doesn't it just give the UTM zone number???
						</li>
					</ul>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<p>
						Now open the empty model <code>exercise4</code>
					</p>
					<p>
						It's best to separate a model from the one for Exercises 1-3
					</p>
					<ul>
						<li>
							Each model (and Python script) should deal with one single purpose
						</li>
						<li>
							Otherwise your coauthors and your future self will get confused
						</li>
					</ul>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
					Exercise #4.1
					</h4>
					<h3>
						Feature To Point
					</h3>
					<p>
						<strong>Input Features</strong>: <code>...\output\river_by_district.shp</code>
					</p>
					<p>
						<strong>Output Feature Class</strong>: <code>...\temporary\river_centroids.shp</code>
					</p>
					<p>
						Uncheck "<strong>Inside</strong>"
					</p>
					<ul>
						<li>
							We need the average location for each river, not the point on river
						</li>
					</ul>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
					Exercise #4.1 (cont.)
					</h4>
					<h3>
						Spatial Join
					</h3>
					<p>
						<strong>Target Features</strong>: river_centroids.shp
					</p>
					<ul>
						<li>
							Output from Feature To Point
						</li>
					</ul>
					<p>
						<strong>Join Features</strong>: <code>C:\Program Files (x86)\ArcGIS\Desktop10.6\Reference Systems\utm.shp</code>
					</p>
					<p>
						<strong>Output Feature Class</strong>: <code>...\Lecture6\temporary\utm_zones.shp</code>
					</p>
				</section>
				<section id="" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
					Spatial Join (cont.)
					</h4>
					<p>
						<strong>Join Operation</strong>: JOIN_ONE_TO_ONE
					</p>
					<p>
						Check "<strong>Keep All Target Features</strong>"
					</p>
					<p>
						<strong>Field Map of Join Features</strong>: leave as it is
					</p>
					<ul>
						<li>
							We handle this in Python later
						</li>
					</ul>
					<p>
						<strong>Match Option</strong>: Intersect
					</p>
				</section>

				<section id="" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
					Exercise #4.1 (cont.)
					</h4>
					<h3>
						Copy Features
					</h3>
					<ul>
						<li>
							To prepare for using Join Field
						</li>
					</ul>
					<p>
						<strong>Input Features</strong>: river_by_district.shp
					</p>
					<p>
						<strong>Output Feature Class</strong>: <code>...\Lecture6\temporary\river_utm.shp</code>
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Join Field
					</h3>
						<p>
							Add fields from another shapefile's attribute table
						</p>
						<ul>
							<li>
								Very much the same as Stata's <code>merge</code>
							</li>
						</ul>
						<p>
							Overwrites the input. So use Copy Features first.
						</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
					Exercise #4.1 (cont.)
					</h4>
					<h3>
						Join Field
					</h3>
					<p>
						<strong>Input Table</strong>: river_utm.shp
					</p>
					<ul>
						<li>
							Output from Copy Features
						</li>
					</ul>
					<p>
						<strong>Input Join Field</strong>: GID_2
					</p>
						<li>
							Name of field in Input Table, to be used for joining
						</li>
				</section>
				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
					Join Field (cont.)
					</h4>
					<p>
						<strong>Join Table</strong>: utmzones.shp
					</p>
					<ul>
						<li>
							Output from Spatial Join
						</li>
					</ul>
					<p>
						<strong>Output Join Field</strong>: GID_2
					</p>
					<ul>
						<li>
							Name of field in <span style="color:red;">Join Table</span>, to be used for joining
						</li>
					</ul>
					<p>
						<strong>Join Field(s)</strong>: check ZONE
					</p>
					<ul>
						<li>
							Field for UTM zone number
						</li>
					</ul>
					<p>
						NOTE: This tool overwrites the input data.
					</p>
				</section>

				<section id="" data-transition="fade-in slide-out" style="text-align: left;">
					<h3>
						Join Field to add your own data
					</h3>
						<p>
							Create your data as a csv file
						</p>
						<p>
							Then use <strong>Table to Table</strong>, to convert it into dBASE format.
						</p>
						<p>
							Finally, use Join Field
						</p>
						<p style="color:slategrey">
							We will learn this in Lecture 7
						</p>
				</section>

				<section id="assignment2" data-transition="fade-in slide-out" style="text-align: left;">
					<img src="gis_lecture6/damsF4.png" style="border:none; background:none; box-shadow:none; width:600px; float:right;">
					<h4>
					Assignment #2
					</h4>
					<h3>
						Mean river gradient map of India
					</h3>
					<p>
						Replicate Figure IV of Duflo & Pande (2007)
					</p>
				</section>

				<section id="" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
					Exercise #4.2: Overview
					</h4>
					<h3>
						Extract rivers by UTM zone
					</h3>
					<p>
						Geo-processing tool: Select (Analysis)
					</p>
					<p>
						This tool keeps features whose field values satisfy the conditions you specify
					</p>
					<p>
						Useful in various situations
					</p>
					<ul>
						<li>
							Keep unmatched areas from Union (cf <a href="../gis_lecture5.html#/table3b" target="_blank">Lec 5</a>)
						</li>
						<li>
							Sample selection (e.g. select India from global data)
						</li>
					</ul>
				</section>

				<section id="" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
					Exercise #4.2
					</h4>
					<h3>
						Select (Analysis)
					</h3>
					<p>
						<strong>Input Features</strong>: river_utm.shp (2)
					</p>
					<ul>
						<li>
							Output from Join Field
						</li>
					</ul>
					<p>
						<strong>Output Feature Class</strong>: ...\Lecture6\temporary\river43.shp
					</p>
					<p>
						<strong>Expression</strong>: <span style="font-size: 1.5em">"ZONE" = 43</span>
					</p>
					<ul>
						<li>
							Field name: must be enclosed by ""
						</li>
						<li>
							See <a href="http://desktop.arcgis.com/en/arcmap/latest/map/working-with-layers/sql-reference-for-query-expressions-used-in-arcgis.htm" target="_blank">ArcGIS Help on SQL reference</a> to learn other syntax rules
						</li>
					</ul>
				</section>

				<section id="" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
					Exercise #4.3
					</h4>
					<h3>
						Project to UTM
					</h3>
					<p>
						Which geo-processing tool(s) should we use?
					</p>
				</section>

				<section id="" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
					Exercise #4.3 (cont.)
					</h4>
					<h3>
						Project
					</h3>
					<p>
						<strong>Input Dataset or Feature Class</strong>: river43.shp
					</p>
					<ul>
						<li>
							Output from Select
						</li>
					</ul>
					<p>
						<strong>Output Dataset or Feature Class</strong>: <code>...\temporary\river43_projected.shp</code>
					</p>
					<p>
						<strong>Output Coordinate System</strong>: WGS_1984_UTM_Zone_43N
					</p>
				</section>

				<section id="" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
					Exercise #4.4
					</h4>
					<h3>
						Calculate river length
					</h3>
					<p>
						Geo-processing tools: Add Geometry Attributes
					</p>
					<p>
						cf. Surface area calculation (<a href="../gis_lecture4.html#/ex2addgeo1" target="_blank">Lecture 4</a>)
					</p>
				</section>

				<section id="ex4add_geo" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
					Exercise #4.4 (cont.)
					</h4>
					<h3>
						Add Geometry Attributes
					</h3>
					<p>
						<strong>Input Features</strong>: river43_projected.shp
					</p>
					<ul>
						<li>
							Output from Project
						</li>
					</ul>
					<p>
						<strong>Geometry Property</strong>: LENGTH
					</p>
					<p>
						<strong>Length Unit</strong>: METERS
					</p>
					<p>
						NOTE: This tool overwrites the input data.
					</p>
				</section>

				<section id="ex4table2excel" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
					Exercise #4.5
					</h4>
					<h3>
						Table To Excel
					</h3>
					<p>
						<strong>Input Table</strong>: river43_projected.shp (2)
					</p>
					<ul>
						<li>
							Output from Add Geometry Attributes
						</li>
					</ul>
					<p>
						<strong>Output Excel File</strong>: <code>...\Lecture6\output\river_length43.xls</code>
					</p>
				</section>

				<section id="ex4addgeo2" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
					An alternative to Exercise #4.3 and #4.4
					</h4>
					<p>
						You can directly use Add Geometry Attributes (cf. <a href="../gis_lecture4.html#/ex2addgeo3" target="_blank">Lecture 4</a>)
					</p>
					<p>
						<strong>Input Features</strong>: river43.shp
					</p>
					<ul>
						<li>
							Output from Select
						</li>
					</ul>
					<p>
						<strong>Geometry Properties</strong>: LENGTH_GEODESIC
					</p>
					<p>
						<strong>Area Unit</strong>: METERS
					</p>
					<p>
						<strong>Coordinate System</strong>: WGS_1984_UTM_Zone_43N
					</p>
					<ul>
						<li>
							If unspecified, the area is calculated based on WGS 1984 (i.e. rubbish)
						</li>
					</ul>
				</section>

				<section id="ex4model_model" data-transition="slide-in slide-out" style="text-align: left;">
					<h3>
						Get ready for Python coding
					</h3>
					<p>
						Now export the model <code>exercise4</code> as a Python script
					</p>
					<p>
						Open both the exported script and the template script (<code>code/template4L6.py</code>) with IDLE
					</p>
					<p>
						We first review what we have learned (cf <a href=" ../gis_lecture2.html#/section6" target="_blank">Lecture 2</a>)
					</p>
					<p>
						Then we create a loop over UTM zones
					</p>
				</section>

				<section id="ex4python1" data-transition="slide-in slide-out" style="text-align: left;">
					<h3>
						Use Try-Except statement (review)
					</h3>
					<ul>
						<li>
							For printing error messages
						</li>
					</ul>
					<p>
						1. Copy geo-processing commands in exported script
					</p>
					<p>
						2. Paste them <span style="color:red;">below</span> <code>try:</code> in template script
					</p>
					<p>
						3. Select them all
					</p>
					<p>
						4. Indent them by pressing the tab key
					</p>
				</section>

				<section id="ex4python2a" data-transition="slide-in fade-out" style="text-align: left;">
					<h3>
						Assign variables to file names (review)
					</h3>
					<ul>
						<li>
							For ease of understanding/editing the script later
						</li>
					</ul>
					<p>
						1. Copy local variables in exported script
					</p>
					<p>
						2. Paste them <span style="color:red;">above</span> <code>try:</code> in template script
					</p>
					<p>
						3. Sort them by inputs, intermediate files, and outputs
					</p>
					<ul>
						<li>
							Inputs: <code>temporary\\river_by_district.shp</code>, <code>...\\utm.shp</code>
						</li>
						<li>
							Outputs: <code>output\\river_length43.xls</code>
						</li>
					</ul>
				</section>

				<section id="ex4python2b" data-transition="fade-in fade-out" style="text-align: left;">
					<h4>
						Assign variables to file names (cont.)
					</h4>
					<p>
						4. Specify the working directory (see <a href="../gis_lecture3.html#/relative-file-path" target="_blank">Lecture 3</a>)
					</p>
					<p style="text-align: center;">
						<code>arcpy.env.workspace = "../"</code>
					</p>
					<p>
						5. Remove directory path from file names
					</p>
					<p style="text-align: center;">
						<code>utm_zones_shp = "C:\\...\\utm_zones.shp"</code>
					</p>
					<p style="text-align: center;">
						$\Downarrow$
					</p>
					<p style="text-align: center;">
						<code>utm_zones_shp = "temporary\\utm_zones.shp"</code>
					</p>

				</section>

				<section id="ex4python2c" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
						Assign variables to file names (cont.)
					</h4>
					<p>
						6. Replace duplicated variables
					</p>
					<ul>
						<li>
							Model Builder duplicates variables for outputs from overwriting tools (Join Field, Add Geometry Attributes)
						</li>
						<li>
							Press ctrl + f (for IDLE, Edit > Replace), to avoid mistakes
						</li>
					</ul>
						<p>
							<code>rivers_utm_shp___2_</code>
						</p>
						<p>
							$\rightarrow$ <code>rivers_utm_shp</code>
						</p>
						<p>
							<code>river43_projected_shp___2_ </code>
						</p>
						<p>
							$\rightarrow$ <code>river43_projected_shp</code>
						</p>
				</section>

				<section id="" data-transition="slide-in slide-out" style="text-align: left;">
					<h3>
						Spatial Join in Python
					</h3>
						<p>
							Replace the lengthy 6th argument with <code>""</code>
						</p>
						<ul>
							<li>
								Otherwise, field GID_2 may become all 0 for some reason...
							</li>
						</ul>
						<p>
							Whenever using Spatial Join in Python, make sure the 6th argument is empty.
						</p>
				</section>
			</section>

			<section>
				<section id="section5">
					<h1>
						5. Loop over values in Python
					</h1>
				</section>

				<section id="" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
						Exercise #4.6: Overview
					</h4>
					<h3>
						Loop over UTM zones
					</h3>
					<p>
						Put the following geo-processing steps into a loop
					</p>
					<ul>
						<li>
							Select, Project, Add Geometry Attributes, Table To Excel
						</li>
					</ul>
					<p>
						At each turn of loop, change:
					</p>
					<p>
						1. UTM zone number for Select
					</p>
					<p style="text-align: center;">
					<code>"\"ZONE\" = 43"</code>
					</p>
					<p>
						2. UTM coordinate system for Project
					</p>
					<p>
						3. Output file names
					</p>
				</section>

				<section id="" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
						Exercise #4.6: Overview (cont.)
					</h4>
					<p>
						Create a loop over values from 43 to 47
					</p>
						<ul>
							<li>
								India ranges from UTM zone 42 to 47
							</li>
							<li>
								There is no river in zone 42
							</li>
						</ul>
					<p>
						To do so, add the following command line
					</p>
						<p style="text-align: center; font-size:1.5em;">
						<code>for zone in range(43,48):</code>
						</p>
				</section>

				<section id="" data-transition="slide-in fade-out" style="text-align: left;">
					<h3>
						Loop over numbers in Python
					</h3>
						<p style="text-align: center; font-size:1.5em;">
						<code>for zone in range(43,48):</code>
						</p>
						<p>
							This command line does the following:
						</p>
						<p>
							1. Creates a variable <code>zone</code> that contains number 43
						</p>
						<p>
							2. Executes all the <em>indented</em> commands below
						</p>
						<p>
							3. Then assigns next number (44) to <code>zone</code>
						</p>
						<p>
							4. Executes all the <em>indented</em> commands below
						</p>
						<p>
							5. Repeats this until number <span style="color:red;">47</span> (not 48!)
						</p>
				</section>

				<section id="other_types_of_loop" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
						Loop over numbers in Python (cont.)
					</h4>
					<p>
						Same can be done by the <strong>while</strong> loop
						<pre style="font-size: 0.7em;">
						<code data-trim>
zone = 43
while zone < 48:
    commands
    zone = zone + 1
						</code>
						</pre>
							or the <strong>list</strong> loop (to be used in Lecture 7)
							<pre style="font-size: 0.7em;">
						<code data-trim>
zoneList = [43,44,45,46,47]
for zone in zoneList:
    commands
						</code>
						</pre>
				</section>



				<section id="ex4python3" data-transition="slide-in slide-out" style="text-align: left;">
					<h4>
						Exercise #4.6 (1)
					</h4>
					<h3>
						Create a loop structure in script
					</h3>
						<p>
							1. Add:
						<p style="text-align: center;">
						<code>for zone in range(43,48):</code>
						</p>
							 above <code>arcpy.Select_analysis...</code>
						</p>
						<p>
							2. Indent the four geo-processing commands
						</p>
						<p>
							Now the code should look like this:
						</p>
					<pre>
						<code data-trim>
for zone in range(43,48):
  # Process: Select
  arcpy.Select_analysis(...)
  # Process: Project
  arcpy.Project_management(...)
  # Process: Add Geometry Attributes
  arcpy.AddGeometryAttributes_management(...)
  # Process: Table To Excel
  arcpy.TableToExcel_conversion(...)
						</code>
					</pre>
				</section>

				<section id="" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
						Exercise #4.6 (2)
					</h4>
					<h3>
						Select a UTM zone number
					</h3>
						<p>
							Let's first understand the syntax for Select tool
						</p>
						<p>
							cf. <a href="http://desktop.arcgis.com/en/arcmap/latest/tools/analysis-toolbox/select.htm" target="_blank">ArcGIS Help on Select</a>
						</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Syntax for Select tool
					</h3>
					<p style="text-align: center; font-size:0.6em;">
						<code data-trim>
arcpy.Select_analysis(<mark>river_utm_shp</mark>, river43_shp, "\"ZONE\"=43")
						</code>
					</p>
					<br>
					<p style="text-align: center;">
						1st argument: input file name
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Syntax for Select tool
					</h3>
					<p style="text-align: center; font-size:0.6em;">
						<code data-trim>
arcpy.Select_analysis(river_utm_shp, <mark>river43_shp</mark>, "\"ZONE\"=43")
						</code>
					</p>
					<br>
					<p style="text-align: center;">
						2nd argument: output file name
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Syntax for Select tool
					</h3>
					<p style="text-align: center; font-size:0.6em;">
						<code data-trim>
arcpy.Select_analysis(river_utm_shp, river43_shp, <mark>"\"ZONE\"=43"</mark>)
						</code>
					</p>
					<br>
					<p style="text-align: center;">
						3rd argument: selection rule
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Syntax for selection rule
					</h3>
					<p style="text-align: center; font-size:1.5em;">
						<code data-trim>
							<mark>"</mark>\"ZONE\"=43<mark>"</mark>
						</code>
					</p>
					<br>
					<p>
						Must be string, thus enclosed by " "
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Syntax for selection rule
					</h3>
					<p style="text-align: center; font-size:1.5em;">
						<code data-trim>
							"<mark>\"</mark>ZONE<mark>\"</mark>=43"
						</code>
					</p>
					<br>
					<p>
						Field name must be enclosed by \" \"
					</p>
					<ul>
						<li>
							" " is used by Python as string enclosure
						</li>
						<li>
							For Python to read " as field name enclosure, add backslash \
						</li>
					</ul>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Syntax for selection rule
					</h3>
					<p style="text-align: center; font-size:1.5em;">
						<code data-trim>
							"\"ZONE\"=<mark>43</mark>"
						</code>
					</p>
					<br>
					<p>
						We want to replace this number at each turn of the loop
					</p>
					<p class="fragment" data-fragment-index="1">
						To do so, write as follows:
					</p>
					<p  class="fragment" data-fragment-index="1" style="text-align: center; font-size:1.5em;">
						<code data-trim>
							"\"ZONE\"="+str(zone)
						</code>
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Number vs String
					</h3>
					<p style="text-align: center; font-size:1.5em;">
						<code data-trim>
							"\"ZONE\"="+str(<mark>zone</mark>)
						</code>
					</p>
					<br>
					<p>
						Variable <code>zone</code> contains number, not string
					</p>
					<p>
						But selection rule expression has to be string
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Convert Number into String
					</h3>
					<p style="text-align: center; font-size:1.5em;">
						<code data-trim>
							"\"ZONE\"="+<mark>str(</mark>zone<mark>)</mark>
						</code>
					</p>
					<br>
					<p>
						So transform number into string by str( )
					</p>
				</section>

				<section id="concatenate" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Concatenate strings
					</h3>
					<p style="text-align: center; font-size:1.5em;">
						<code data-trim>
							"\"ZONE\"="<mark>+</mark>str(zone)
						</code>
					</p>
					<br>
					<p>
						To "concatenate" (i.e. connect) two strings, use +
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Concactenate strings
					</h3>
					<p style="text-align: center; font-size:1.5em;">
						<code data-trim>
							<mark>"</mark>\"ZONE\"=<mark>"</mark>+str(zone)
						</code>
					</p>
					<br>
					<p>
						Don't forget to enclose a string with " "
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Summary (1/4)
					</h3>
					<p style="text-align: center; font-size:1.5em;">
						<code data-trim>
							<mark>"\"ZONE\"="</mark>+<mark>str(zone)</mark>
						</code>
					</p>
					<br>
					<p>
						We have two strings
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Summary (2/4)
					</h3>
					<p style="text-align: center; font-size:1.5em;">
						<code data-trim>
							"\"ZONE\"="<mark>+</mark>str(zone)
						</code>
					</p>
					<br>
					<p>
						We have two strings concatenated by +
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Summary (3/4)
					</h3>
					<p style="text-align: center; font-size:1.5em;">
						<code data-trim>
							"\"ZONE\"="+<mark>str(</mark>zone<mark>)</mark>
						</code>
					</p>
					<br>
					<p>
						Number must be converted into string by str()
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Summary (4/4)
					</h3>
					<p style="text-align: center; font-size:1.5em;">
						<code data-trim>
							"<mark>\"</mark>ZONE<mark>\"</mark>="+str(zone)
						</code>
					</p>
					<br>
					<p>
						Field name must be enclosed by \" \"
					</p>
				</section>

				<section id="" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
						Exercise #4.6 (2)
					</h4>
					<p>
						Replace the 3rd argument for the Select tool
					</p>
					<p style="text-align: center; font-size:1.5em;">
						<code data-trim>
							"\"ZONE\"= 43"
						</code>
					</p>
					<p>
						with
					</p>
					<p style="text-align: center; font-size:1.5em;">
						<code data-trim>
							"\"ZONE\"="+str(zone)
						</code>
					</p>
				</section>

				<section id="" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
						Exercise #4.6 (3)
					</h4>
					<h3>
						Specify UTM projection
					</h3>
						<p>
							Let's first understand the syntax for Project tool
						</p>
						<p>
							cf. <a href="https://pro.arcgis.com/en/pro-app/tool-reference/data-management/project.htm#GUID-529F0CFA-5C94-4229-BD79-507B17C18E71" target="_blank">ArcGIS Help on Project</a>
						</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Syntax for Project tool
					</h3>
					<p style="text-align: center; font-size:0.6em;">
						<code data-trim>
arcpy.Project_management(<mark>river43_shp</mark>, river43_projected_shp, "PROJCS[...
						</code>
					</p>
					<br>
					<p style="text-align: center;">
						1st argument: input file name
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Syntax for Project tool
					</h3>
					<p style="text-align: center; font-size:0.6em;">
						<code data-trim>
arcpy.Project_management(river43_shp, <mark>river43_projected_shp</mark>, "PROJCS[...
						</code>
					</p>
					<br>
					<p style="text-align: center;">
						2nd argument: output file name
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Syntax for Project tool
					</h3>
					<p style="text-align: center; font-size:0.6em;">
						<code data-trim>
arcpy.Project_management(river43_shp, river43_projected_shp, <mark>"PROJCS[...</mark>
						</code>
					</p>
					<br>
					<p style="text-align: center;">
						3rd argument: coordinate system name
					</p>
					<p style="text-align: center;">
						(too long to be shown in this slide)
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						Specify coordinate system in Python
					</h3>
					<p>
						Use factory code (unique ID for each coordinate system)
					</p>
					<ul>
						<li>
							<a href="https://pro.arcgis.com/en/pro-app/arcpy/classes/pdf/geographic_coordinate_systems.pdf" target="_blank">List for geographic coordinate sytems (PDF)</a>
						</li>
						<li>
							<a href="https://pro.arcgis.com/en/pro-app/arcpy/classes/pdf/projected_coordinate_systems.pdf" target="_blank">List for projected coordinate systems (PDF)</a>
						</li>
					</ul>
					<p>
						UTM projections for zones 43-47:
					</p>
					<p style="margin-left: 40px;">
						32643, 32644, 32645, 32646, 32647
					</p>
					<p>
						Then use <strong>SpatialReference</strong> method
					</p>

				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						SpatialReference method
					</h3>
					<p style="font-size:0.6em;">
						<code><mark>factorycode = 32643</mark></code>
					</p>
					<p style="font-size:0.6em;">
						<code>cs = arcpy.SpatialReference(factorycode)</code>
					</p>
					<p style="font-size:0.6em;">
						<code>arcpy.Project_management(river43_shp, river43_projected_shp, cs)</code>
					</p>
					<br>
					<p>
						Create a variable for factory code
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						SpatialReference method
					</h3>
					<p style="font-size:0.6em;">
						<code>factorycode = 32643</code>
					</p>
					<p style="font-size:0.6em;">
						<code>cs = arcpy.SpatialReference<mark>(factorycode)</mark></code>
					</p>
					<p style="font-size:0.6em;">
						<code>arcpy.Project_management(river43_shp, river43_projected_shp, cs)</code>
					</p>
					<br>
					<p>
						SpatialReference method takes factory code as input
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						SpatialReference method
					</h3>
					<p style="font-size:0.6em;">
						<code>factorycode = 32643</code>
					</p>
					<p style="font-size:0.6em;">
						<code>cs = <mark>arcpy.SpatialReference(factorycode)</mark></code>
					</p>
					<p style="font-size:0.6em;">
						<code>arcpy.Project_management(river43_shp, river43_projected_shp, cs)</code>
					</p>
					<br>
					<p>
						Then returns that long string name for coordinate system
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						SpatialReference method
					</h3>
					<p style="font-size:0.6em;">
						<code>factorycode = 32643</code>
					</p>
					<p style="font-size:0.6em;">
						<code><mark>cs = </mark>arcpy.SpatialReference(factorycode)</code>
					</p>
					<p style="font-size:0.6em;">
						<code>arcpy.Project_management(river43_shp, river43_projected_shp, cs)</code>
					</p>
					<br>
					<p>
						We assign variable <code>cs</code> to coordinate system name
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						SpatialReference method
					</h3>
					<p style="font-size:0.6em;">
						<code>factorycode = 32643</code>
					</p>
					<p style="font-size:0.6em;">
						<code>cs = arcpy.SpatialReference(factorycode)</code>
					</p>
					<p style="font-size:0.6em;">
						<code>arcpy.Project_management(river43_shp, river43_projected_shp, <mark>cs</mark>)</code>
					</p>
					<br>
					<p>
						Use it as 3rd argument for Project
					</p>
				</section>

				<section id="" data-transition="fade-in fade-out" style="text-align: left;">
					<h3>
						SpatialReference method in loop
					</h3>
					<p style="font-size:0.6em;">
						<code>for zone in range(43,48):</code>
					</p>
					<p style="margin-left: 55px; font-size:0.6em;">
						<code>    factorycode = <mark>32600 + zone</mark></code>
					</p>
					<p style="margin-left: 55px; font-size:0.6em;">
						<code>    cs = arcpy.SpatialReference(factorycode)</code>
					</p>
					<p style="margin-left: 55px; font-size:0.6em;">
						<code>    arcpy.Project_management(river43_shp, river43_projected_shp, cs)</code>
					</p>
					<br>
					<p>
						Then use variable <code>zone</code> to change factory code for each turn of the loop
					</p>
					<ul>
						<li>
							Factory code must be number, not string
						</li>
						<li>
							So don't use <code>str(zone)</code>
						</li>
					</ul>
				</section>

				<section id="" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
						Exercise #4.6 (3)
					</h4>
					<p>
						Modify the script as follows (marked in yellow)
					</p>
					<p style="font-size:0.6em;">
						<code>for zone in range(43,48):</code>
					</p>
					<p style="margin-left: 55px; font-size:0.6em;">
						<code>    arcpy.Select_analysis(river_utm_shp, river43_shp, "\"ZONE\" = " + str(zone))
</code>
					</p>
					<p style="margin-left: 55px; font-size:0.6em;">
						<code>    <mark>factorycode = 32600 + zone</mark></code>
					</p>
					<p style="margin-left: 55px; font-size:0.6em;">
						<code>    <mark>cs = arcpy.SpatialReference(factorycode)</mark></code>
					</p>
					<p style="margin-left: 55px; font-size:0.6em;">
						<code>    arcpy.Project_management(river43_shp, river43_projected_shp, <mark>cs</mark>)</code>
					</p>
				</section>

				<section id="" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
						Exercise #4 Step 5 (4)
					</h4>
					<h3>
						Output file names
					</h3>
						<p>
							Select the names of files to be created within loop
						</p>
						<p>
							Cut-and-paste them to beginning of loop
						</p>
					<p style="font-size:0.6em;">
						<code>for zone in range(43,48):</code>
					</p>
					<p style="margin-left: 55px; font-size:0.6em;">
						<code>    <mark>river43_shp = "river43.shp"</mark></code>
					</p>
					<p style="margin-left: 55px; font-size:0.6em;">
						<code>    <mark>river43_projected_shp = "river43_projected.shp"</mark></code>
					</p>
					<p style="margin-left: 55px; font-size:0.6em;">
						<code>    <mark>river_length43_xls =  "river_length43.xls"</mark></code>
					</p>
						<p>
							Don't forget indenting them
						</p>
				</section>

				<section id="" data-transition="fade-in slide-out" style="text-align: left;">
					<h3>
						Output file names
					</h3>
						<p>
							Replace <code>43</code> <span style="color:red;">in the file names</span> with <code>"+str(zone)+"</code>
						</p>
						<ul>
							<li>
								Do not change variable names!
							</li>
						</ul>
					<p style="font-size:0.6em;">
						<code>for zone in range(43,48):</code>
					</p>
					<p style="margin-left: 55px; font-size:0.6em;">
						<code>    river43_shp = "rivers<mark>"+str(zone)+"</mark>.shp"</code>
					</p>
					<p style="margin-left: 55px; font-size:0.6em;">
						<code>    river43_projected_shp = "rivers_pj<mark>"+str(zone)+"</mark>.shp"</code>
					</p>
					<p style="margin-left: 55px; font-size:0.6em;">
						<code>    river_length43_xls = "river_length<mark>"+str(zone)+"</mark>.xls"</code>
					</p>
						<p>
							This way, each turn of the loop will create different files
						</p>
				</section>

				<section id="" data-transition="slide-in fade-out" style="text-align: left;">
					<h4>
						Exercise #4 Step 5 (5)
					</h4>
					<h3>
						Print commands
					</h3>
						<p>
							To explain what each command line does, add:
						</p>
						<p style="text-align: center;">
							<code>print "..."</code>
						</p>
						<ul>
							<li>
								This allows you to monitor which part of the script is being run
							</li>
							<li>
								What follows after <code>print</code> must be a string
							</li>
							<li>
								You can use string variables
							</li>
						</ul>
				</section>
				<section id="" data-transition="fade-in slide-out" style="text-align: left;">
					<h4>
						Print commands (cont.)
					</h4>
						<p>
							To indicate each turn of the loop:
						</p>

						<pre style="font-size:0.9em;">
							<code data-trim>
for zone in range(43,48):
    print "Processing UTM zone "+str(zone)
							</code>
						</pre>
						<p>
							Another example of <a href="#/concatenate" target="_blank">string concatenation</a>
				</section>

				<section id="ex4model_script" data-transition="slide-out slide-in" style="text-align: left;">
					<p>
						Now run the script by pressing F5 in IDLE
					</p>
				</section>

				<section id="ex4model_script" data-transition="slide-out slide-in" style="text-align: left;">
					<h3>
					Model Python Script for Exercise 4
					</h3>
					<p>
						Look at <code>solutions4exercises/exercise4.py</code>
					</p>
				</section>

			</section>

				<section id="lessons" style="text-align: left;">
					<h3>
						What we've learned on ArcGIS
					</h3>
					<ol>
						<li>
							Covert elevation raster into gradient raster
						</li>
						<li>
							Create indicator raster
						</li>
						<li>
							Attach UTM zone numbers to features
						</li>
						<li>
							Calculate length of polyline features
						</li>
					</ol>
					<p>
						Do you remember which geo-processing tools you used for each of these tasks?
					</p>
				</section>

			</div>
			<!-- To end the reconfiguration of an HTML5 <section> element as a slide using CSS. -->

		</div>
		<!-- To end the activation of the CSS framework of Reveal.js -->

		<!-- Java script commands should be placed at the bottom of an HTML file, to reduce the perceived loading time  -->

		<!-- Load head.js, providing a number of utility classses. http://headjs.com/ -->
		<script src="lib/js/head.min.js"></script>
		<!-- Load reveal.js -->
		<script src="js/reveal.js"></script>

		<!-- Import MathJax, to use TeX for mathematic expressions -->
		<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
		<!-- Allow inline math expressions by using $ -->
		<!-- http://tex.stackexchange.com/questions/27633/mathjax-inline-mode-not-rendering -->
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
		    tex2jax: {
		      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
		      processEscapes: true
		    }
		  });
		</script>

		<script>
			// Set the options for Reveal.js
			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true, // Enable the navigation arrows on bottom right
				progress: true,
				history: true,
				center: true,
				rollingLinks: false, // Disable the default rolling links

				transition: 'slide', // Choose from: none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
